<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DUVETICA 주차별 매출 대시보드</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #3498db;
            --primary-dark: #2980b9;
            --secondary: #95a5a6;
            --success: #27ae60;
            --danger: #e74c3c;
            --warning: #f39c12;
            --border: #e0e0e0;
            --background: #ffffff;
            --text: #1a1a1a;
            --text-light: #666666;
            --light-bg: #f8f9fa;
            --shadow: 0 2px 8px rgba(0,0,0,0.08);
            --shadow-hover: 0 8px 24px rgba(0,0,0,0.12);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8ec 100%);
            color: var(--text);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            animation: fadeInUp 0.6s ease-out;
        }
        
        /* 애니메이션 */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes countUp {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .animate-delay-1 { animation-delay: 0.1s; }
        .animate-delay-2 { animation-delay: 0.2s; }
        .animate-delay-3 { animation-delay: 0.3s; }
        
        /* 헤더 - 그라데이션 배경 */
        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            text-align: center;
            padding: 40px 30px;
            border-radius: 16px;
            margin-bottom: 40px;
            box-shadow: var(--shadow-hover);
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 60%);
            pointer-events: none;
        }
        
        .header-content {
            position: relative;
            z-index: 1;
        }
        
        .logo-space {
            width: 60px;
            height: 60px;
            background: rgba(255,255,255,0.2);
            border-radius: 12px;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }
        
        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 8px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .header .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            font-weight: 400;
        }
        
        /* AI 분석 섹션 */
        .ai-section {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 24px;
            margin-bottom: 40px;
        }
        
        .ai-box {
            background: var(--background);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 24px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            animation: fadeInUp 0.6s ease-out backwards;
        }
        
        .ai-box:hover {
            box-shadow: var(--shadow-hover);
            transform: translateY(-4px);
        }
        
        .ai-box h3 {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--border);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .ai-box h3 .icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }
        
        .ai-box.insight h3 { color: var(--primary); }
        .ai-box.insight h3 .icon { background: rgba(52, 152, 219, 0.1); }
        
        .ai-box.warning h3 { color: var(--warning); }
        .ai-box.warning h3 .icon { background: rgba(243, 156, 18, 0.1); }
        
        .ai-box.action h3 { color: var(--success); }
        .ai-box.action h3 .icon { background: rgba(39, 174, 96, 0.1); }
        
        .ai-box ul {
            list-style: none;
            padding: 0;
        }
        
        .ai-box li {
            padding: 8px 0;
            font-size: 0.9rem;
            border-bottom: 1px dotted var(--border);
            transition: var(--transition);
            padding-left: 20px;
            position: relative;
        }
        
        .ai-box li:last-child {
            border-bottom: none;
        }
        
        .ai-box li::before {
            content: '→';
            position: absolute;
            left: 0;
            color: var(--secondary);
            font-size: 0.8rem;
        }
        
        .ai-box li:hover {
            background: var(--light-bg);
            margin: 0 -12px;
            padding-left: 32px;
            padding-right: 12px;
            border-radius: 6px;
        }
        
        /* AI 분석 텍스트 스타일 */
        .ai-box .positive {
            color: #27ae60;
            font-weight: 600;
        }
        
        .ai-box .negative {
            color: #e74c3c;
            font-weight: 600;
        }
        
        .ai-box .highlight {
            background: linear-gradient(120deg, #fff3cd 0%, #fff3cd 100%);
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
        }
        
        .ai-box.insight li::before {
            content: '✓';
            color: #27ae60;
        }
        
        .ai-box.warning li::before {
            content: '!';
            color: #f39c12;
            font-weight: 700;
        }
        
        .ai-box.action li::before {
            content: '▶';
            color: #3498db;
        }
        
        /* BEST 제품 순위 섹션 */
        .best-products {
            display: grid;
            grid-template-columns: 7fr 3fr;
            grid-template-rows: auto auto;
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .best-products .best-card:nth-child(3) {
            grid-column: 1 / -1;
        }
        
        .best-card {
            background: var(--background);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 24px;
            box-shadow: var(--shadow);
            animation: fadeInUp 0.6s ease-out backwards;
        }
        
        .best-card:hover {
            box-shadow: var(--shadow-hover);
        }
        
        .best-card h3 {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--light-bg);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .best-card h3 .emoji {
            font-size: 1.3rem;
        }
        
        .best-card table {
            width: 100%;
            font-size: 0.85rem;
        }
        
        .best-card th {
            background: var(--light-bg);
            padding: 10px 12px;
            font-weight: 600;
            text-align: left;
        }
        
        .best-card td {
            padding: 10px 12px;
            border-bottom: 1px solid var(--border);
        }
        
        .best-card tbody tr:hover {
            background: rgba(52, 152, 219, 0.05);
        }
        
        .best-card tbody tr.rank-1 {
            background: linear-gradient(90deg, rgba(255, 215, 0, 0.3) 0%, rgba(255, 215, 0, 0.1) 100%);
        }
        
        .best-card tbody tr.rank-2 {
            background: linear-gradient(90deg, rgba(192, 192, 192, 0.3) 0%, rgba(192, 192, 192, 0.1) 100%);
        }
        
        .best-card tbody tr.rank-3 {
            background: linear-gradient(90deg, rgba(205, 127, 50, 0.3) 0%, rgba(205, 127, 50, 0.1) 100%);
        }
        
        .rank-cell {
            text-align: center;
            font-weight: 700;
            font-size: 1rem;
            width: 50px;
            min-width: 50px;
            white-space: nowrap;
        }
        
        .rank-cell.medal-gold,
        .rank-cell.medal-silver,
        .rank-cell.medal-bronze {
            font-size: 1.1rem;
        }
        
        .spec-cell {
            font-size: 0.8rem;
            color: #666;
            white-space: nowrap;
        }
        
        /* 판매율 테이블 최적화 (좁은 공간) */
        .sell-rate-card .compact-table {
            font-size: 0.82rem;
        }
        
        .sell-rate-card .compact-table .product-name {
            max-width: 120px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .sell-rate-card .compact-table th,
        .sell-rate-card .compact-table td {
            padding: 8px 6px;
        }
        
        .medal-gold { color: #FFD700; text-shadow: 0 1px 2px rgba(0,0,0,0.2); }
        .medal-silver { color: #C0C0C0; text-shadow: 0 1px 2px rgba(0,0,0,0.2); }
        .medal-bronze { color: #CD7F32; text-shadow: 0 1px 2px rgba(0,0,0,0.2); }
        
        .product-name {
            font-weight: 500;
            max-width: 200px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .category-badge {
            font-size: 0.75rem;
            padding: 3px 8px;
            background: var(--light-bg);
            border-radius: 12px;
            color: var(--text-light);
            font-weight: 500;
        }
        
        .gender-badge {
            font-size: 0.75rem;
            padding: 3px 8px;
            border-radius: 12px;
            font-weight: 500;
        }
        
        .gender-badge.women {
            background: #fce4ec;
            color: #c2185b;
        }
        
        .gender-badge.men {
            background: #e3f2fd;
            color: #1976d2;
        }
        
        .rate-highlight {
            font-weight: 600;
            color: var(--primary);
        }
        
        .status-cell {
            text-align: center;
        }
        
        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .badge-success {
            background: rgba(39, 174, 96, 0.15);
            color: var(--success);
        }
        
        .badge-danger {
            background: rgba(231, 76, 60, 0.15);
            color: var(--danger);
        }
        
        .badge-normal {
            background: var(--light-bg);
            color: var(--text-light);
        }
        
        /* 카테고리별 BEST 상품 섹션 - 3열 그리드 */
        .category-best-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 24px;
            margin-bottom: 40px;
        }
        
        .category-best-section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
        }
        
        .category-best-section:hover {
            box-shadow: 0 4px 16px rgba(0,0,0,0.12);
        }
        
        .category-best-section.women {
            border: 2px solid #ffe4e6;
        }
        
        .category-best-section.men {
            border: 2px solid #e0f2fe;
        }
        
        .category-best-section.neutral {
            border: 2px solid #e0e0e0;
        }
        
        .category-best-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid #f0f0f0;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .category-best-title .emoji {
            font-size: 1.2rem;
        }
        
        .category-best-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.8rem;
            color: #1a1a1a;
        }
        
        .category-best-table thead {
            background: #f8f9fa;
        }
        
        .category-best-table th {
            padding: 10px 8px;
            text-align: center;
            font-weight: 600;
            border-bottom: 2px solid #e0e0e0;
            white-space: nowrap;
            color: #1a1a1a;
        }
        
        .category-best-table td {
            padding: 10px 8px;
            border-bottom: 1px solid #e0e0e0;
            vertical-align: middle;
            color: #1a1a1a;
        }
        
        /* 모든 섹션 텍스트 색상 통일 */
        .category-best-section,
        .category-best-section.women,
        .category-best-section.men,
        .category-best-section.neutral {
            color: #1a1a1a;
        }
        
        .category-best-section .name-cell,
        .category-best-section .sales-cell,
        .category-best-section .qty-cell,
        .category-best-section .rank-cell {
            color: #1a1a1a;
        }
        
        .category-best-table tbody tr {
            height: 44px;
        }
        
        .category-best-table tbody tr:nth-child(-n+3) {
            background: #fffbea;
        }
        
        .category-best-table tbody tr:hover {
            background: #f8f9fa;
        }
        
        .category-best-table .rank-cell {
            text-align: center;
            font-weight: 700;
            width: 40px;
        }
        
        .category-best-table .name-cell {
            text-align: left;
            font-weight: 500;
            max-width: 100px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .category-best-table .sales-cell {
            text-align: right;
            font-family: 'JetBrains Mono', monospace;
            font-weight: 500;
        }
        
        .category-best-table .qty-cell {
            text-align: right;
            font-family: 'JetBrains Mono', monospace;
        }
        
        .gender-badge-small {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: 500;
        }
        
        .gender-badge-small.women {
            background: #ffe4e6;
            color: #c2185b;
        }
        
        .gender-badge-small.men {
            background: #e0f2fe;
            color: #1565c0;
        }
        
        .gender-badge-small.all {
            background: #f0f0f0;
            color: #666;
        }
        
        @media (max-width: 1200px) {
            .category-best-container {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .category-best-container {
                grid-template-columns: 1fr;
            }
            
            .category-best-table {
                font-size: 0.75rem;
            }
        }
        
        /* 섹션 헤더 (접기/펼치기 버튼 포함) */
        .cumulative-section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding: 16px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            color: white;
        }
        
        .cumulative-section-header h2 {
            margin: 0;
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .toggle-btn {
            padding: 8px 16px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .toggle-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        /* 주간 BEST 섹션 */
        .weekly-section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 48px 0 24px;
            padding: 16px 20px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 12px;
            color: white;
        }
        
        .weekly-section-header h2 {
            margin: 0;
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .weekly-section-header .toggle-btn {
            padding: 8px 16px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .weekly-section-header .toggle-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .weekly-best-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 16px;
            margin-bottom: 48px;
        }
        
        .weekly-best-card {
            background: white;
            border-radius: 10px;
            padding: 14px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
        }
        
        .weekly-best-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.12);
        }
        
        .weekly-best-card.women {
            border-top: 3px solid #e91e63;
        }
        
        .weekly-best-card.men {
            border-top: 3px solid #2196f3;
        }
        
        .weekly-best-card.neutral {
            border-top: 3px solid #9e9e9e;
        }
        
        .weekly-best-title {
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .weekly-best-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.72rem;
            color: #1a1a1a;
        }
        
        .weekly-best-table th {
            padding: 6px 4px;
            text-align: center;
            font-weight: 600;
            background: #f8f9fa;
            border-bottom: 1px solid #e0e0e0;
            font-size: 0.68rem;
        }
        
        .weekly-best-table td {
            padding: 6px 4px;
            border-bottom: 1px solid #f0f0f0;
            color: #1a1a1a;
        }
        
        .weekly-best-table .rank-cell {
            text-align: center;
            font-weight: 600;
            width: 28px;
        }
        
        .weekly-best-table .name-cell {
            text-align: left;
            max-width: 80px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .weekly-best-table .sales-cell,
        .weekly-best-table .qty-cell {
            text-align: right;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.7rem;
        }
        
        .weekly-best-table tbody tr:first-child {
            background: #fffbea;
        }
        
        @media (max-width: 1400px) {
            .weekly-best-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 900px) {
            .weekly-best-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 600px) {
            .weekly-best-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* KPI 카드 (2x3 그리드) */
        .kpi-cards {
            display: grid;
            grid-template-columns: 2fr 3fr 1fr;
            grid-template-rows: repeat(2, auto);
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .kpi-card {
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.2s, box-shadow 0.2s;
            animation: fadeInUp 0.6s ease-out backwards;
        }
        
        .kpi-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
        }
        
        .kpi-card .kpi-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 16px;
        }
        
        .kpi-card .kpi-icon {
            font-size: 1.5rem;
        }
        
        .kpi-card .kpi-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text);
        }
        
        .kpi-card .kpi-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2rem;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 8px;
        }
        
        .kpi-card .kpi-comparison {
            font-size: 15px;
            color: var(--text-light);
            margin-bottom: 8px;
            white-space: nowrap;
        }
        
        .kpi-card .kpi-comparison .value,
        .kpi-card .kpi-comparison .unit {
            font-size: 15px;
            font-weight: normal;
        }
        
        .kpi-card .kpi-change {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 12px;
        }
        
        .kpi-card .kpi-change.positive { color: #27ae60; }
        .kpi-card .kpi-change.negative { color: #e74c3c; }
        
        .kpi-card .kpi-sub {
            font-size: 15px;
            color: var(--text-light);
            padding-top: 12px;
            border-top: 1px solid rgba(0,0,0,0.1);
            white-space: nowrap;
        }
        
        .kpi-card .kpi-sub .value,
        .kpi-card .kpi-sub .unit {
            font-size: 15px;
            font-weight: normal;
        }
        
        .kpi-card .kpi-sub-value {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            color: var(--text);
        }
        
        .kpi-card .kpi-sub-change {
            font-size: 15px;
            margin-left: 6px;
        }
        
        .kpi-card .kpi-sub-change.positive { color: #27ae60; }
        .kpi-card .kpi-sub-change.negative { color: #e74c3c; }
        
        /* KPI 카드 배경색 */
        .kpi-card.bg-blue { background: #e3f2fd; }
        .kpi-card.bg-purple { background: #f3e5f5; }
        .kpi-card.bg-teal { background: #e0f2f1; }
        .kpi-card.bg-green { background: #e8f5e9; }
        .kpi-card.bg-orange { background: #fff3e0; }
        .kpi-card.bg-red { background: #ffebee; }
        
        /* 통일된 KPI 카드 레이아웃 */
        .kpi-card .kpi-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 16px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(0,0,0,0.08);
        }
        
        .kpi-card .kpi-header .kpi-icon {
            font-size: 1.3rem;
        }
        
        .kpi-card .kpi-header .kpi-title {
            font-size: 0.95rem;
            font-weight: 600;
            color: #333;
        }
        
        .kpi-card .kpi-body {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }
        
        .kpi-item {
            flex: 1;
            min-width: 100px;
            text-align: center;
            padding: 8px 6px;
            border-right: 1px solid #e8e8e8;
        }
        
        .kpi-item:last-child {
            border-right: none;
        }
        
        .kpi-item.full-width {
            flex: 1 1 100%;
            border-right: none;
        }
        
        .kpi-label {
            font-size: 0.8rem;
            color: #888;
            margin-bottom: 6px;
            font-weight: 500;
        }
        
        .kpi-main {
            margin-bottom: 8px;
        }
        
        .kpi-value {
            font-size: 26px;
            font-weight: bold;
            color: #333;
            font-family: 'JetBrains Mono', monospace;
        }
        
        .unit {
            font-size: 14px;
            color: #666;
            margin-left: 2px;
        }
        
        .kpi-comparison {
            font-size: 13px;
            line-height: 1.4;
            color: #666;
        }
        
        .comparison-label {
            font-size: 11px;
            color: #999;
            margin-bottom: 1px;
        }
        
        .comparison-value {
            font-size: 13px;
            color: #666;
            margin-bottom: 2px;
        }
        
        .comparison-growth {
            font-size: 13px;
            font-weight: bold;
        }
        
        .comparison-growth.positive {
            color: #2e7d32;
        }
        
        .comparison-growth.negative {
            color: #d32f2f;
        }
        
        .comparison-growth.neutral {
            color: #666;
        }
        
        .kpi-card .kpi-footer {
            margin-top: 12px;
            padding-top: 10px;
            border-top: 1px solid #e0e0e0;
            font-size: 13px;
            color: #888;
            text-align: center;
        }
        
        .kpi-note {
            font-size: 0.85rem;
            color: #666;
            text-align: center;
            font-style: italic;
        }
        
        .kpi-card .kpi-footer .growth {
            font-size: 15px;
            font-weight: 600;
        }
        
        .kpi-card .kpi-footer .growth.positive { color: #27ae60; }
        .kpi-card .kpi-footer .growth.negative { color: #e74c3c; }
        
        /* 기존 호환성 */
        .kpi-section { display: none; }
        .kpi-divider { display: none; }
        
        .kpi-card .comparison {
            font-size: 0.85rem;
            color: var(--text-light);
            margin-bottom: 8px;
        }
        
        .kpi-card .change {
            font-size: 1.2rem;
            font-weight: 600;
            padding: 6px 16px;
            border-radius: 20px;
            display: inline-block;
        }
        
        .kpi-card .change.positive {
            color: var(--success);
            background: rgba(39, 174, 96, 0.1);
        }
        
        .kpi-card .change.negative {
            color: var(--danger);
            background: rgba(231, 76, 60, 0.1);
        }
        
        /* 섹션 공통 */
        .section {
            background: var(--background);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 28px;
            margin-bottom: 40px;
            box-shadow: var(--shadow);
            animation: fadeInUp 0.6s ease-out backwards;
        }
        
        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 2px solid var(--light-bg);
        }
        
        .section-header h3 {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-header h3 .emoji {
            font-size: 1.3rem;
        }
        
        .section-header h3 .unit-note {
            font-size: 0.85rem;
            font-weight: 400;
            color: #888;
            margin-left: 8px;
        }
        
        /* 2단 헤더 테이블 */
        .two-row-header thead .header-row-1 th {
            background: #f5f5f5;
            font-weight: 700;
            border-bottom: 1px solid #ddd;
        }
        
        .two-row-header thead .header-row-2 th {
            background: #fafafa;
            font-weight: 600;
            font-size: 0.85rem;
            border-bottom: 2px solid #ddd;
        }
        
        .two-row-header thead .group-header {
            text-align: center;
            border-left: 1px solid #ddd;
            border-right: 1px solid #ddd;
        }
        
        /* 컴팩트 테이블 */
        .compact-table {
            font-size: 0.88rem;
        }
        
        .compact-table th,
        .compact-table td {
            padding: 10px 8px;
        }
        
        .compact-table .header-row-1 th {
            font-size: 0.95rem;
        }
        
        .compact-table .header-row-2 th {
            font-size: 0.82rem;
        }
        
        .compact-table .number-cell {
            font-family: 'JetBrains Mono', monospace;
        }
        
        /* ========================================
           카테고리 분석 테이블 스타일
           ======================================== */
        .category-analysis-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
            border: 2px solid #dee2e6;
        }
        
        .category-analysis-table th,
        .category-analysis-table td {
            border: 1px solid #dee2e6;
            padding: 10px 12px;
            text-align: right;
        }
        
        .category-analysis-table td:first-child {
            text-align: left;
        }
        
        /* 헤더 스타일 */
        .category-analysis-table .header-row-1 th {
            background: linear-gradient(180deg, #f8f9fa 0%, #e9ecef 100%);
            font-weight: 700;
            text-align: center;
            padding: 12px 8px;
        }
        
        .category-analysis-table .header-row-2 th {
            background: #f1f3f5;
            font-weight: 600;
            font-size: 0.8rem;
            text-align: center;
            padding: 8px 6px;
        }
        
        .category-analysis-table .th-category {
            width: 120px;
            text-align: center !important;
        }
        
        .category-analysis-table .th-group {
            border-bottom: 2px solid #adb5bd;
        }
        
        .category-analysis-table .th-sales { background: #e3f2fd !important; }
        .category-analysis-table .th-qty { background: #f3e5f5 !important; }
        .category-analysis-table .th-intag { background: #e8f5e9 !important; }
        .category-analysis-table .th-rate { background: #fff3e0 !important; }
        
        /* 행 스타일 */
        .category-analysis-table .row-total {
            background-color: #f8f9fa !important;
            font-weight: 700;
        }
        
        .category-analysis-table .row-women {
            background-color: #ffe4e6 !important;
            font-weight: 700;
        }
        
        .category-analysis-table .row-women-sub {
            background-color: #fff5f7 !important;
        }
        
        .category-analysis-table .row-men {
            background-color: #e0f2fe !important;
            font-weight: 700;
        }
        
        .category-analysis-table .row-men-sub {
            background-color: #f0f9ff !important;
        }
        
        .category-analysis-table .row-acc,
        .category-analysis-table .row-shoes {
            background-color: #f8f9fa !important;
            font-weight: 700;
        }
        
        /* 숫자 색상 */
        .category-analysis-table .num-positive {
            color: #27ae60;
            font-weight: 600;
        }
        
        .category-analysis-table .num-negative {
            color: #e74c3c;
            font-weight: 600;
        }
        
        .category-analysis-table .num-zero {
            color: #95a5a6;
        }
        
        /* 카테고리명 */
        .category-analysis-table .cat-name {
            font-weight: 600;
        }
        
        .category-analysis-table .cat-emoji {
            margin-right: 4px;
        }
        
        /* 숫자 셀 */
        .category-analysis-table .num-cell {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.82rem;
        }
        
        /* 호버 효과 */
        .category-analysis-table tbody tr:hover {
            filter: brightness(0.97);
        }
        
        /* 차트 */
        .chart-container {
            height: 400px;
            position: relative;
        }
        
        /* 테이블 */
        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            font-size: 0.9rem;
        }
        
        th {
            background: var(--light-bg);
            padding: 14px 16px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid var(--border);
            position: sticky;
            top: 0;
            cursor: pointer;
            user-select: none;
            transition: var(--transition);
        }
        
        th:hover {
            background: #eee;
        }
        
        th .sort-icon {
            margin-left: 6px;
            opacity: 0.3;
            font-size: 0.7rem;
        }
        
        th.sorted .sort-icon {
            opacity: 1;
        }
        
        td {
            padding: 12px 16px;
            border-bottom: 1px solid var(--border);
            transition: var(--transition);
        }
        
        tbody tr {
            transition: var(--transition);
        }
        
        tbody tr:nth-child(even) {
            background: rgba(248, 249, 250, 0.5);
        }
        
        tbody tr:hover {
            background: rgba(52, 152, 219, 0.05);
            transform: scale(1.005);
        }
        
        .total-row {
            background: linear-gradient(90deg, rgba(52, 152, 219, 0.08) 0%, rgba(52, 152, 219, 0.02) 100%) !important;
            font-weight: 600;
        }
        
        .parent-row {
            background: var(--light-bg) !important;
            font-weight: 600;
        }
        
        .sub-row td:first-child {
            color: var(--text-light);
        }
        
        .indent {
            display: inline-block;
            width: 20px;
        }
        
        .category-cell {
            text-align: left;
        }
        
        .number-cell {
            text-align: right;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
        }
        
        .positive { color: var(--success); font-weight: 600; }
        .negative { color: var(--danger); font-weight: 600; }
        .neutral { color: var(--secondary); }
        
        /* Women Down 상세 테이블 */
        .detail-section {
            margin-top: 20px;
        }
        
        .detail-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            padding: 12px 0;
        }
        
        .detail-header .toggle-icon {
            font-size: 1.2rem;
            transition: var(--transition);
        }
        
        .detail-header.collapsed .toggle-icon {
            transform: rotate(-90deg);
        }
        
        .detail-tables {
            display: flex;
            flex-direction: column;
            gap: 20px;
            overflow: hidden;
            transition: var(--transition);
        }
        
        .detail-tables.collapsed {
            max-height: 0;
            opacity: 0;
            margin-top: 0;
        }
        
        /* Women Down 카드 - 좌우 2단 레이아웃 */
        .detail-table {
            display: grid;
            grid-template-columns: 1fr 1.5fr;
            gap: 0;
            background: var(--light-bg);
            border-radius: 12px;
            padding: 0;
            width: 100%;
            transition: var(--transition);
            overflow: hidden;
        }
        
        .detail-table:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .detail-table .left-section {
            padding: 25px;
            border-right: 1px solid #e0e0e0;
            background: #f8f9fa;
        }
        
        .detail-table .left-section h4 {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--text);
            padding-bottom: 12px;
            border-bottom: 2px solid var(--primary);
        }
        
        .detail-table .left-section .ai-insights {
            font-size: 0.9rem;
            line-height: 1.8;
        }
        
        .detail-table .left-section .ai-insights p {
            margin: 10px 0;
            padding: 8px 12px;
            background: white;
            border-radius: 8px;
            border-left: 3px solid #27ae60;
        }
        
        .detail-table .left-section .ai-insights p.warning {
            border-left-color: #f39c12;
        }
        
        .detail-table .left-section .ai-insights p.danger {
            border-left-color: #e74c3c;
        }
        
        .detail-table .right-section {
            padding: 25px;
        }
        
        .detail-table .right-section h4 {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: #666;
        }
        
        .detail-table .right-section table {
            width: 100%;
            font-size: 0.85rem;
        }
        
        .detail-table .right-section th,
        .detail-table .right-section td {
            padding: 10px 12px;
        }
        
        .detail-table .right-section tbody tr:nth-child(even) {
            background: rgba(255,255,255,0.5);
        }
        
        /* 비교 테이블 2단 헤더 */
        .detail-table .right-section table th {
            background-color: #f5f5f5;
            font-size: 0.82rem;
            padding: 8px 6px;
            text-align: center;
            border: 1px solid #e0e0e0;
        }
        
        .detail-table .right-section table td {
            font-size: 0.85rem;
            padding: 8px 6px;
            text-align: center;
            border: 1px solid #e0e0e0;
            font-family: 'JetBrains Mono', monospace;
        }
        
        .detail-table .right-section table td:first-child {
            text-align: left;
            font-family: inherit;
        }
        
        /* 효율 분석 색상 */
        .efficiency-high {
            color: #2e7d32 !important;
            font-weight: bold;
            background-color: #e8f5e9 !important;
        }
        
        .efficiency-low {
            color: #d32f2f !important;
            font-weight: bold;
            background-color: #ffebee !important;
        }
        
        .efficiency-neutral {
            color: #666 !important;
        }
        
        /* AI 인사이트 - 긍정/경고 구분 */
        .ai-insights .insights-positive p {
            border-left-color: #27ae60;
        }
        
        .ai-insights .insights-warnings p {
            border-left-color: #f39c12;
            background: #fff8e1;
        }
        
        .ai-insights .insights-warnings p.danger {
            border-left-color: #e74c3c;
            background: #ffebee;
        }
        
        .detail-table th, .detail-table td {
            padding: 10px 12px;
        }
        
        .detail-table tbody tr:nth-child(even) {
            background: rgba(255,255,255,0.5);
        }
        
        /* AI 인사이트 박스 (Detail Table 위) */
        .detail-insight {
            background: #e3f2fd;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            margin-bottom: 10px;
            font-size: 14px;
            line-height: 1.6;
            color: var(--text);
        }
        
        .detail-insight strong {
            color: var(--primary);
        }
        
        /* Golden Zone 섹션 */
        .golden-zone {
            margin-top: 30px;
            padding-top: 24px;
            border-top: 2px solid var(--border);
        }
        
        .golden-zone h4 {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .golden-zone .subtitle {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 20px;
        }
        
        /* Golden Zone 테이블 스타일 */
        .golden-zone-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }
        
        .golden-zone-table th {
            background-color: #f5f5f5;
            padding: 12px 8px;
            text-align: center;
            border: 1px solid #e0e0e0;
            font-size: 0.85rem;
            font-weight: 600;
        }
        
        .golden-zone-table td {
            padding: 12px 10px;
            border: 1px solid #e0e0e0;
            font-family: 'JetBrains Mono', monospace;
        }
        
        .golden-zone-table tr:hover {
            background-color: #f9f9f9;
        }
        
        .golden-zone .rank-1 {
            background: linear-gradient(90deg, rgba(255, 215, 0, 0.3) 0%, rgba(255, 215, 0, 0.1) 100%) !important;
        }
        
        .golden-zone .rank-2 {
            background: linear-gradient(90deg, rgba(192, 192, 192, 0.3) 0%, rgba(192, 192, 192, 0.1) 100%) !important;
        }
        
        .golden-zone .rank-3 {
            background: linear-gradient(90deg, rgba(205, 127, 50, 0.3) 0%, rgba(205, 127, 50, 0.1) 100%) !important;
        }
        
        .golden-zone .high-rate {
            font-weight: 700;
        }
        
        .golden-zone .high-efficiency {
            background: #e8f5e9 !important;
        }
        
        .golden-zone .combo-cell {
            font-weight: 600;
            text-align: left !important;
            font-family: inherit;
        }
        
        .golden-zone .score-cell {
            color: #1976d2;
            font-weight: bold;
        }
        
        /* Golden Zone AI 인사이트 카드 - 깔끔한 전문적 디자인 */
        .golden-zone-insight-card {
            background: #ffffff;
            border: 2px solid #e0e0e0;
            border-left: 5px solid #1976d2;
            border-radius: 8px;
            padding: 25px 30px;
            margin-bottom: 25px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.08);
        }
        
        .golden-zone-insight-card h4 {
            margin: 0 0 20px 0;
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 12px;
        }
        
        .golden-zone-insight-card .insight-content {
            font-size: 0.92rem;
            line-height: 1.9;
            color: #444;
        }
        
        .golden-zone-insight-card .insight-content p {
            margin: 14px 0;
            padding-left: 20px;
            position: relative;
        }
        
        .golden-zone-insight-card .insight-content p::before {
            content: "•";
            position: absolute;
            left: 0;
            color: #1976d2;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .golden-zone-insight-card .insight-content strong {
            color: #1976d2;
            font-weight: 600;
        }
        
        .golden-zone-insight-card .insight-highlight {
            color: #1976d2;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
        }
        
        .golden-zone-insight-card .insight-divider {
            border-top: 1px solid #e0e0e0;
            margin: 18px 0;
        }
        
        /* 상품 수 컬럼 스타일 */
        .golden-zone-table .product-count-24 {
            color: #666;
        }
        
        .golden-zone-table .product-count-25 {
            font-weight: bold;
            color: #1976d2;
        }
        
        .golden-zone-table .product-count-change-positive {
            color: #2e7d32;
            font-weight: bold;
        }
        
        .golden-zone-table .product-count-change-negative {
            color: #d32f2f;
            font-weight: bold;
        }
        
        .golden-zone-table .product-count-change-zero {
            color: #666;
        }
        
        /* 푸터 */
        .footer {
            text-align: center;
            padding: 24px;
            color: var(--text-light);
            font-size: 0.85rem;
            border-top: 1px solid var(--border);
            margin-top: 20px;
        }
        
        .footer .version {
            font-weight: 600;
            color: var(--primary);
        }
        
        /* 맨 위로 버튼 */
        .scroll-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 50px;
            height: 50px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: var(--shadow-hover);
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            font-size: 1.2rem;
            z-index: 1000;
        }
        
        .scroll-top.visible {
            opacity: 1;
            visibility: visible;
        }
        
        .scroll-top:hover {
            background: var(--primary-dark);
            transform: translateY(-4px);
        }
        
        /* 반응형 */
        @media (max-width: 1024px) {
            .ai-section {
                grid-template-columns: 1fr;
            }
            
            .best-products {
                grid-template-columns: 1fr;
            }
            
            .best-products .best-card:nth-child(3) {
                grid-column: auto;
            }
            
            .sell-rate-card .compact-table .product-name {
                max-width: none;
            }
            
            .kpi-cards {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .kpi-card .kpi-metric-value,
            .kpi-card .kpi-value,
            .kpi-card .value {
                font-size: 22px;
            }
            
            .kpi-card .unit {
                font-size: 12px;
            }
            
            .kpi-divider {
                display: none;
            }
        }
        
        @media (max-width: 768px) {
            .best-products {
                grid-template-columns: 1fr;
            }
            
            .kpi-cards {
                grid-template-columns: 1fr;
            }
            
            .detail-table {
                grid-template-columns: 1fr;
            }
            
            .detail-table .left-section {
                border-right: none;
                border-bottom: 1px solid #e0e0e0;
            }
            
            .kpi-card .kpi-metric-value,
            .kpi-card .kpi-value,
            .kpi-card .value {
                font-size: 20px;
            }
            
            .kpi-card .unit {
                font-size: 11px;
            }
            
            .kpi-section {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .kpi-card .value {
                font-size: 2.2rem;
            }
            
            .chart-container {
                height: 300px;
            }
            
            body {
                padding: 12px;
            }
            
            .section {
                padding: 20px;
                border-radius: 12px;
            }
            
            .table-wrapper {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
        }
    </style>
</head>
<body>
<div class="container">
    <!-- 헤더 -->
    <div class="header">
        <div class="header-content">
            <div class="logo-space">📊</div>
            <h1>DUVETICA 주차별 매출 대시보드</h1>
            <p class="subtitle">25FW vs 24FW 분석 리포트</p>
        </div>
    </div>
    
    <!-- AI 분석 섹션 -->
    <div class="ai-section">
        <div class="ai-box insight animate-delay-1">
            <h3><span class="icon">✅</span>핵심 인사이트 (잘된 점)</h3>
            <ul id="ai-insights">
                <li>데이터 분석 중...</li>
            </ul>
        </div>
        
        <div class="ai-box warning animate-delay-2">
            <h3><span class="icon">⚠️</span>주의사항 (개선 필요)</h3>
            <ul id="ai-warnings">
                <li>데이터 분석 중...</li>
            </ul>
        </div>
        
        <div class="ai-box action animate-delay-3">
            <h3><span class="icon">🎯</span>향후 실행 계획 (Action Items)</h3>
            <ul id="ai-actions">
                <li>데이터 분석 중...</li>
            </ul>
        </div>
    </div>
    
    <!-- KPI 카드 (2x3 그리드) -->
    <div class="kpi-cards" id="kpiCards">
        <!-- KPI 카드는 JavaScript로 동적 생성 -->
        <div style="text-align:center; padding:40px; color:#888;">KPI 데이터 로딩중...</div>
    </div>
    
    <!-- BEST 제품 순위 -->
    <div class="best-products">
        <div class="best-card animate-delay-1">
            <h3><span class="emoji">🏆</span>Top 10 매출 제품 (25FW)</h3>
            <table>
                <thead>
                    <tr>
                        <th style="text-align:center">순위</th>
                        <th>제품명</th>
                        <th>성별</th>
                        <th>카테고리</th>
                        <th>Fabric × Length × Downweight</th>
                        <th style="text-align:right">매출액</th>
                        <th style="text-align:right">판매수량</th>
                    </tr>
                </thead>
                <tbody id="bestProductsTableBody">
                    <!-- 동적 로딩 -->
                </tbody>
            </table>
        </div>
        
        <div class="best-card animate-delay-2 sell-rate-card">
            <h3><span class="emoji">🔥</span>Top 10 판매율 제품 (25FW)</h3>
            <table class="compact-table">
                <thead>
                    <tr>
                        <th style="text-align:center">순위</th>
                        <th>제품명</th>
                        <th style="text-align:right">판매율</th>
                        <th style="text-align:center">상태</th>
        </tr>
                </thead>
                <tbody id="bestSellRateTableBody">
                    <tr><td colspan="4" style="text-align:center; padding:20px;">데이터 로딩 중...</td></tr>
                </tbody>
            </table>
        </div>
        
        <div class="best-card animate-delay-3">
            <h3><span class="emoji">🚀</span>판매량 급상승 상품 Top 10 (전주 대비 판매 증감)</h3>
            <table>
                <thead>
                    <tr>
                        <th style="text-align:center">순위</th>
                        <th>제품명</th>
                        <th>성별</th>
                        <th>카테고리</th>
                        <th style="text-align:right">전주</th>
                        <th style="text-align:right">금주</th>
                        <th style="text-align:right">전주 대비</th>
                        <th style="text-align:right" title="시즌 전체 판매율">누적 판매율</th>
                    </tr>
                </thead>
                <tbody id="trendingBody">
                    <tr><td colspan="8" style="text-align:center; padding:20px;">데이터 로딩 중...</td></tr>
                </tbody>
            </table>
        </div>
    </div>
    
    <!-- 누적 BEST 섹션 -->
    <div id="cumulativeBestSection">
        <div class="cumulative-section-header">
            <h2>📊 누적 BEST - 카테고리별 TOP 10 (25FW 전체)</h2>
            <button id="toggleCumulativeBest" class="toggle-btn">접기 ▲</button>
        </div>
        <div id="cumulativeBestContent" class="category-best-container">
            <!-- WOMEN OUTER -->
        <div class="category-best-section women">
            <div class="category-best-title">
                <span class="emoji">👗</span> WOMEN OUTER - TOP 10 매출 (25FW)
            </div>
            <table class="category-best-table">
                <thead>
                    <tr>
                        <th>순위</th>
                        <th>제품명</th>
                        <th>매출액</th>
                        <th>판매수량</th>
        </tr>
                </thead>
                <tbody id="womenOuterBestBody">
                    <tr><td colspan="4" style="text-align:center; padding:20px;">로딩중...</td></tr>
                </tbody>
            </table>
        </div>
        
        <!-- WOMEN TOP -->
        <div class="category-best-section women">
            <div class="category-best-title">
                <span class="emoji">👕</span> WOMEN TOP - TOP 10 매출 (25FW)
            </div>
            <table class="category-best-table">
                <thead>
                    <tr>
                        <th>순위</th>
                        <th>제품명</th>
                        <th>매출액</th>
                        <th>판매수량</th>
        </tr>
                </thead>
                <tbody id="womenTopBestBody">
                    <tr><td colspan="4" style="text-align:center; padding:20px;">로딩중...</td></tr>
                </tbody>
            </table>
        </div>
        
        <!-- WOMEN BOTTOM -->
        <div class="category-best-section women">
            <div class="category-best-title">
                <span class="emoji">👖</span> WOMEN BOTTOM - TOP 10 매출 (25FW)
            </div>
            <table class="category-best-table">
                <thead>
                    <tr>
                        <th>순위</th>
                        <th>제품명</th>
                        <th>매출액</th>
                        <th>판매수량</th>
        </tr>
                </thead>
                <tbody id="womenBottomBestBody">
                    <tr><td colspan="4" style="text-align:center; padding:20px;">로딩중...</td></tr>
                </tbody>
            </table>
        </div>
        
        <!-- MEN DOWN -->
        <div class="category-best-section men">
            <div class="category-best-title">
                <span class="emoji">🧥</span> MEN DOWN - TOP 10 매출 (25FW)
            </div>
            <table class="category-best-table">
                <thead>
                    <tr>
                        <th>순위</th>
                        <th>제품명</th>
                        <th>매출액</th>
                        <th>판매수량</th>
        </tr>
                </thead>
                <tbody id="menDownBestBody">
                    <tr><td colspan="4" style="text-align:center; padding:20px;">로딩중...</td></tr>
                </tbody>
            </table>
        </div>
        
        <!-- MEN OUTER -->
        <div class="category-best-section men">
            <div class="category-best-title">
                <span class="emoji">🧥</span> MEN OUTER - TOP 10 매출 (25FW)
            </div>
            <table class="category-best-table">
                <thead>
                    <tr>
                        <th>순위</th>
                        <th>제품명</th>
                        <th>매출액</th>
                        <th>판매수량</th>
        </tr>
                </thead>
                <tbody id="menOuterBestBody">
                    <tr><td colspan="4" style="text-align:center; padding:20px;">로딩중...</td></tr>
                </tbody>
            </table>
        </div>
        
        <!-- MEN TOP -->
        <div class="category-best-section men">
            <div class="category-best-title">
                <span class="emoji">👔</span> MEN TOP - TOP 10 매출 (25FW)
            </div>
            <table class="category-best-table">
                <thead>
                    <tr>
                        <th>순위</th>
                        <th>제품명</th>
                        <th>매출액</th>
                        <th>판매수량</th>
        </tr>
                </thead>
                <tbody id="menTopBestBody">
                    <tr><td colspan="4" style="text-align:center; padding:20px;">로딩중...</td></tr>
                </tbody>
            </table>
        </div>
        
        <!-- MEN BOTTOM -->
        <div class="category-best-section men">
            <div class="category-best-title">
                <span class="emoji">👖</span> MEN BOTTOM - TOP 10 매출 (25FW)
            </div>
            <table class="category-best-table">
                <thead>
                    <tr>
                        <th>순위</th>
                        <th>제품명</th>
                        <th>매출액</th>
                        <th>판매수량</th>
        </tr>
                </thead>
                <tbody id="menBottomBestBody">
                    <tr><td colspan="4" style="text-align:center; padding:20px;">로딩중...</td></tr>
                </tbody>
            </table>
        </div>
        
        <!-- ACC -->
        <div class="category-best-section neutral">
            <div class="category-best-title">
                <span class="emoji">👜</span> ACC - TOP 10 매출 (25FW)
            </div>
            <table class="category-best-table">
                <thead>
                    <tr>
                        <th>순위</th>
                        <th>제품명</th>
                        <th>매출액</th>
                        <th>판매수량</th>
        </tr>
                </thead>
                <tbody id="accBestBody">
                    <tr><td colspan="4" style="text-align:center; padding:20px;">로딩중...</td></tr>
                </tbody>
            </table>
    </div>
    
        <!-- SHOES -->
        <div class="category-best-section neutral">
            <div class="category-best-title">
                <span class="emoji">👞</span> SHOES - TOP 10 매출 (25FW)
            </div>
            <table class="category-best-table">
                <thead>
                    <tr>
                        <th>순위</th>
                        <th>제품명</th>
                        <th>매출액</th>
                        <th>판매수량</th>
                    </tr>
                </thead>
                <tbody id="shoesBestBody">
                    <tr><td colspan="4" style="text-align:center; padding:20px;">로딩중...</td></tr>
                </tbody>
            </table>
        </div>
        </div>
    </div>
    
    <!-- 주간 BEST 섹션 -->
    <div id="weeklyBestSection">
        <div class="weekly-section-header">
            <h2>🔥 주간 BEST - 최근 주차 TOP 5 (49w)</h2>
            <button id="toggleWeeklyBest" class="toggle-btn">접기 ▲</button>
        </div>
        <div id="weeklyBestContent" class="weekly-best-grid">
            <!-- 여성 DOWN -->
            <div class="weekly-best-card women">
                <div class="weekly-best-title">
                    <span>🔥</span> 여성 DOWN 주간 BEST
                </div>
                <table class="weekly-best-table">
                    <thead>
                        <tr>
                            <th>순위</th>
                            <th>제품명</th>
                            <th>매출액</th>
                            <th>수량</th>
                        </tr>
                    </thead>
                    <tbody id="weeklyWomenDownBody">
                        <tr><td colspan="4" style="text-align:center;">로딩중...</td></tr>
                    </tbody>
                </table>
            </div>
            
            <!-- 여성 OUTER -->
            <div class="weekly-best-card women">
                <div class="weekly-best-title">
                    <span>👗</span> 여성 OUTER 주간 BEST
                </div>
                <table class="weekly-best-table">
                    <thead>
                        <tr>
                            <th>순위</th>
                            <th>제품명</th>
                            <th>매출액</th>
                            <th>수량</th>
                        </tr>
                    </thead>
                    <tbody id="weeklyWomenOuterBody">
                        <tr><td colspan="4" style="text-align:center;">로딩중...</td></tr>
                    </tbody>
                </table>
            </div>
            
            <!-- 여성 TOP -->
            <div class="weekly-best-card women">
                <div class="weekly-best-title">
                    <span>👕</span> 여성 TOP 주간 BEST
                </div>
                <table class="weekly-best-table">
                    <thead>
                        <tr>
                            <th>순위</th>
                            <th>제품명</th>
                            <th>매출액</th>
                            <th>수량</th>
                        </tr>
                    </thead>
                    <tbody id="weeklyWomenTopBody">
                        <tr><td colspan="4" style="text-align:center;">로딩중...</td></tr>
                    </tbody>
                </table>
            </div>
            
            <!-- 여성 BOTTOM -->
            <div class="weekly-best-card women">
                <div class="weekly-best-title">
                    <span>👖</span> 여성 BOTTOM 주간 BEST
                </div>
                <table class="weekly-best-table">
                    <thead>
                        <tr>
                            <th>순위</th>
                            <th>제품명</th>
                            <th>매출액</th>
                            <th>수량</th>
                        </tr>
                    </thead>
                    <tbody id="weeklyWomenBottomBody">
                        <tr><td colspan="4" style="text-align:center;">로딩중...</td></tr>
                    </tbody>
                </table>
            </div>
            
            <!-- 남성 DOWN -->
            <div class="weekly-best-card men">
                <div class="weekly-best-title">
                    <span>🧥</span> 남성 DOWN 주간 BEST
                </div>
                <table class="weekly-best-table">
                    <thead>
                        <tr>
                            <th>순위</th>
                            <th>제품명</th>
                            <th>매출액</th>
                            <th>수량</th>
                        </tr>
                    </thead>
                    <tbody id="weeklyMenDownBody">
                        <tr><td colspan="4" style="text-align:center;">로딩중...</td></tr>
                    </tbody>
                </table>
            </div>
            
            <!-- 남성 OUTER -->
            <div class="weekly-best-card men">
                <div class="weekly-best-title">
                    <span>🧥</span> 남성 OUTER 주간 BEST
                </div>
                <table class="weekly-best-table">
                    <thead>
                        <tr>
                            <th>순위</th>
                            <th>제품명</th>
                            <th>매출액</th>
                            <th>수량</th>
                        </tr>
                    </thead>
                    <tbody id="weeklyMenOuterBody">
                        <tr><td colspan="4" style="text-align:center;">로딩중...</td></tr>
                    </tbody>
                </table>
            </div>
            
            <!-- 남성 TOP -->
            <div class="weekly-best-card men">
                <div class="weekly-best-title">
                    <span>👔</span> 남성 TOP 주간 BEST
                </div>
                <table class="weekly-best-table">
                    <thead>
                        <tr>
                            <th>순위</th>
                            <th>제품명</th>
                            <th>매출액</th>
                            <th>수량</th>
                        </tr>
                    </thead>
                    <tbody id="weeklyMenTopBody">
                        <tr><td colspan="4" style="text-align:center;">로딩중...</td></tr>
                    </tbody>
                </table>
            </div>
            
            <!-- 남성 BOTTOM -->
            <div class="weekly-best-card men">
                <div class="weekly-best-title">
                    <span>👖</span> 남성 BOTTOM 주간 BEST
                </div>
                <table class="weekly-best-table">
                    <thead>
                        <tr>
                            <th>순위</th>
                            <th>제품명</th>
                            <th>매출액</th>
                            <th>수량</th>
                        </tr>
                    </thead>
                    <tbody id="weeklyMenBottomBody">
                        <tr><td colspan="4" style="text-align:center;">로딩중...</td></tr>
                    </tbody>
                </table>
            </div>
            
            <!-- ACC -->
            <div class="weekly-best-card neutral">
                <div class="weekly-best-title">
                    <span>👜</span> ACC 주간 BEST
                </div>
                <table class="weekly-best-table">
                    <thead>
                        <tr>
                            <th>순위</th>
                            <th>제품명</th>
                            <th>매출액</th>
                            <th>수량</th>
                        </tr>
                    </thead>
                    <tbody id="weeklyAccBody">
                        <tr><td colspan="4" style="text-align:center;">로딩중...</td></tr>
                    </tbody>
                </table>
            </div>
            
            <!-- SHOES -->
            <div class="weekly-best-card neutral">
                <div class="weekly-best-title">
                    <span>👞</span> SHOES 주간 BEST
                </div>
                <table class="weekly-best-table">
                    <thead>
                        <tr>
                            <th>순위</th>
                            <th>제품명</th>
                            <th>매출액</th>
                            <th>수량</th>
                        </tr>
                    </thead>
                    <tbody id="weeklyShoesBody">
                        <tr><td colspan="4" style="text-align:center;">로딩중...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- 주차별 매출 그래프 -->
    <div class="section">
        <div class="section-header">
            <h3><span class="emoji">📈</span>주차별 매출 추이</h3>
        </div>
        <div class="chart-container">
            <canvas id="weeklyChart"></canvas>
        </div>
    </div>
    
    <!-- 카테고리 매출 테이블 -->
    <div class="section">
        <div class="section-header">
            <h3><span class="emoji">📊</span>카테고리별 매출 분석 <span class="unit-note">(매출/입고: 백만원, 판매율: %)</span></h3>
        </div>
        <div class="table-wrapper">
            <table id="categoryTable" class="category-analysis-table">
                <thead>
                    <tr class="header-row-1">
                        <th rowspan="2" class="th-category">카테고리</th>
                        <th colspan="3" class="th-group th-sales">매출</th>
                        <th colspan="3" class="th-group th-qty">판매수량</th>
                        <th colspan="3" class="th-group th-intag">입고금액</th>
                        <th colspan="3" class="th-group th-rate">판매율</th>
                    </tr>
                    <tr class="header-row-2">
                        <th class="th-sub">24FW</th>
                        <th class="th-sub">25FW</th>
                        <th class="th-sub">성장률</th>
                        <th class="th-sub">24FW</th>
                        <th class="th-sub">25FW</th>
                        <th class="th-sub">증감</th>
                        <th class="th-sub">24FW</th>
                        <th class="th-sub">25FW</th>
                        <th class="th-sub">성장률</th>
                        <th class="th-sub">24FW</th>
                        <th class="th-sub">25FW</th>
                        <th class="th-sub">변화</th>
        </tr>
                </thead>
                <tbody id="categorySummaryTableBody">
                    <tr><td colspan="13" style="text-align:center; padding:20px;">데이터 로딩 중...</td></tr>
                </tbody>
            </table>
        </div>
    </div>
    
    <!-- Women Down 상세 분석 -->
    <div class="section">
        <div class="section-header detail-header" onclick="toggleDetail()">
            <h3><span class="emoji">👗</span>Women Down 상세 분석</h3>
            <span class="toggle-icon">▼</span>
        </div>
        <div class="detail-tables" id="detailTables">
            <div class="detail-table" id="fabricCard">
                <div class="left-section">
                    <h4>🎨 Fabric 분석</h4>
                    <div class="ai-insights" id="fabricInsights">
                        <p>데이터 로딩 중...</p>
                    </div>
                </div>
                <div class="right-section">
                    <h4>📊 전년대비 매출 효율 분석</h4>
                <table>
                    <thead>
                        <tr>
                                <th rowspan="2">속성</th>
                                <th colspan="2">매출 (백만원)</th>
                                <th rowspan="2">성장률</th>
                                <th colspan="2">판매율 (%)</th>
                                <th rowspan="2">변화</th>
                        </tr>
                            <tr>
                                <th>24FW</th>
                                <th>25FW</th>
                                <th>24FW</th>
                                <th>25FW</th>
        </tr>
                        </thead>
                        <tbody id="fabricTableBody">
                            <!-- 동적 로딩 -->
                    </tbody>
                </table>
                </div>
            </div>
            
            <div class="detail-table" id="lengthCard">
                <div class="left-section">
                    <h4>📏 Length 분석</h4>
                    <div class="ai-insights" id="lengthInsights">
                        <p>데이터 로딩 중...</p>
                    </div>
                </div>
                <div class="right-section">
                    <h4>📊 전년대비 매출 효율 분석</h4>
                <table>
                    <thead>
                        <tr>
                                <th rowspan="2">속성</th>
                                <th colspan="2">매출 (백만원)</th>
                                <th rowspan="2">성장률</th>
                                <th colspan="2">판매율 (%)</th>
                                <th rowspan="2">변화</th>
                        </tr>
                            <tr>
                                <th>24FW</th>
                                <th>25FW</th>
                                <th>24FW</th>
                                <th>25FW</th>
        </tr>
                        </thead>
                        <tbody id="lengthTableBody">
                            <!-- 동적 로딩 -->
                    </tbody>
                </table>
                </div>
            </div>
            
            <div class="detail-table" id="downweightCard">
                <div class="left-section">
                    <h4>⚖️ Downweight 분석</h4>
                    <div class="ai-insights" id="downweightInsights">
                        <p>데이터 로딩 중...</p>
                    </div>
                </div>
                <div class="right-section">
                    <h4>📊 전년대비 매출 효율 분석</h4>
                <table>
                    <thead>
                        <tr>
                                <th rowspan="2">속성</th>
                                <th colspan="2">매출 (백만원)</th>
                                <th rowspan="2">성장률</th>
                                <th colspan="2">판매율 (%)</th>
                                <th rowspan="2">변화</th>
                            </tr>
                            <tr>
                                <th>24FW</th>
                                <th>25FW</th>
                                <th>24FW</th>
                                <th>25FW</th>
                        </tr>
                    </thead>
                        <tbody id="downweightTableBody">
                            <!-- 동적 로딩 -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Golden Zone 분석 -->
        <div class="golden-zone" id="goldenZone">
            <h4>🏆 Golden Zone 분석 (Fabric × Length × Downweight)</h4>
            <p class="subtitle">가장 효율이 높은 조합 TOP 10 (조합별 전체 제품 합계 기준)</p>
            
            <!-- AI 인사이트 카드 -->
            <div class="golden-zone-insight-card">
                <h4>AI 심층 인사이트</h4>
                <div id="goldenZoneInsights" class="insight-content">
                    <p>데이터 분석 중...</p>
                </div>
            </div>
            
            <div class="table-wrapper">
                <table id="goldenZoneTable" class="golden-zone-table">
                    <thead>
                        <tr>
                            <th rowspan="2" style="width:50px">순위</th>
                            <th rowspan="2">조합<br>(Fabric × Length × Downweight)</th>
                            <th colspan="3">상품 수</th>
                            <th colspan="2">매출 (백만원)</th>
                            <th rowspan="2">성장률</th>
                            <th colspan="2">판매율 (%)</th>
                            <th rowspan="2">판매율<br>변화</th>
                            <th rowspan="2">효율<br>점수</th>
        </tr>
        <tr>
                            <th>24FW</th>
                            <th>25FW</th>
                            <th>증감</th>
                            <th>24FW</th>
                            <th>25FW</th>
                            <th>24FW</th>
                            <th>25FW</th>
        </tr>
                    </thead>
                    <tbody id="goldenZoneBody">
                        <tr><td colspan="12" style="text-align:center; padding:20px;">데이터 로딩 중...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- 푸터 -->
    <div class="footer">
        <p>Generated at <strong>2025-11-27 19:57:19</strong> | <span class="version">DUVETICA 주차별 매출 대시보드</span></p>
        <p>Data Period: 최신 주차 기준 | Source: 24FW & 25FW Sales Data</p>
    </div>
    
    <!-- 맨 위로 버튼 -->
    <button class="scroll-top" onclick="scrollToTop()" id="scrollTopBtn">↑</button>
    
    <script>
        // 주차별 매출 차트 인스턴스 (전역 변수)
        let weeklyChart = null;
        
        // 주차별 매출 차트 CSV 로드 및 렌더링
        async function loadWeeklySalesChart() {
            try {
                const response = await fetch('weekly_sales.csv');
                if (!response.ok) {
                    throw new Error('weekly_sales.csv 로딩 실패: ' + response.status);
                }
                
                const csvText = await response.text();
                const lines = csvText.trim().split('\n');
                
                const labels = [];
                const data24 = [];
                const data25 = [];
                
                // CSV 파싱 (헤더 제외) - 모든 주차 데이터 로드
                // 구조: week_no,sales_24,sales_25
                for (let i = 1; i < lines.length; i++) {
                    const cols = lines[i].split(',');
                    const weekNo = cols[0].trim();
                    
                    if (weekNo) {
                        labels.push(weekNo);
                        data24.push(parseFloat(cols[1]) || 0);
                        data25.push(parseFloat(cols[2]) || 0);
                    }
                }
                
                // 기존 차트 제거 후 새로 생성
        const ctx = document.getElementById('weeklyChart').getContext('2d');
                
                if (weeklyChart) {
                    weeklyChart.destroy();
                }
                
                weeklyChart = new Chart(ctx, {
            type: 'line',
            data: {
                        labels: labels,
                datasets: [
                    {
                        label: '24FW',
                                data: data24,
                                borderColor: '#3498db',
                                backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 5,
                        pointHoverRadius: 8,
                                pointBackgroundColor: '#3498db',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2
                    },
                    {
                        label: '25FW',
                                data: data25,
                                borderColor: '#e74c3c',
                                backgroundColor: 'rgba(231, 76, 60, 0.15)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 5,
                        pointHoverRadius: 8,
                                pointBackgroundColor: '#e74c3c',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                animation: {
                    duration: 1500,
                    easing: 'easeInOutQuart'
                },
                interaction: {
                    intersect: false,
                    mode: 'index'
                },
                plugins: {
                    legend: {
                        position: 'top',
                        align: 'end',
                        labels: {
                            usePointStyle: true,
                            padding: 20,
                            font: {
                                family: "'Inter', sans-serif",
                                size: 12,
                                weight: '500'
                            }
                        }
                    },
                    tooltip: {
                        backgroundColor: 'rgba(26, 26, 26, 0.9)',
                        titleFont: { family: "'Inter', sans-serif", size: 13, weight: '600' },
                        bodyFont: { family: "'JetBrains Mono', monospace", size: 12 },
                        padding: 12,
                        cornerRadius: 8,
                        callbacks: {
                            label: function(context) {
                                const value = (context.raw / 1000000).toFixed(0);
                                return context.dataset.label + ': ' + value + '백만원';
                            },
                            afterBody: function(tooltipItems) {
                                if (tooltipItems.length >= 2) {
                                    const val24 = tooltipItems[0].raw;
                                    const val25 = tooltipItems[1].raw;
                                            if (val24 > 0) {
                                    const growth = ((val25 - val24) / val24 * 100).toFixed(1);
                                    return '\n성장률: ' + (growth > 0 ? '+' : '') + growth + '%';
                                            }
                                }
                                return '';
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return (value / 1000000) + '백만';
                            },
                            font: { family: "'JetBrains Mono', monospace", size: 11 }
                        },
                        grid: {
                            color: 'rgba(0, 0, 0, 0.05)',
                            drawBorder: false
                        }
                    },
                    x: {
                        ticks: {
                            font: { family: "'Inter', sans-serif", size: 11 }
                        },
                        grid: {
                            display: false
                        }
                    }
                }
            }
        });
                
                console.log('✅ 주차별 매출 차트 로딩 완료');
                
            } catch (error) {
                console.error('❌ 주차별 매출 차트 로딩 실패:', error);
            }
        }
        
        // 테이블 정렬 기능
        document.querySelectorAll('#categoryTable th[data-sort]').forEach(th => {
            th.addEventListener('click', function() {
                const table = this.closest('table');
                const tbody = table.querySelector('tbody');
                const rows = Array.from(tbody.querySelectorAll('tr'));
                const sortKey = this.dataset.sort;
                const isAsc = this.classList.contains('sorted-asc');
                
                // 정렬 클래스 초기화
                table.querySelectorAll('th').forEach(h => h.classList.remove('sorted', 'sorted-asc', 'sorted-desc'));
                this.classList.add('sorted', isAsc ? 'sorted-desc' : 'sorted-asc');
                
                // 정렬 로직
                rows.sort((a, b) => {
                    let aVal, bVal;
                    switch(sortKey) {
                        case 'category':
                            aVal = a.cells[0].textContent.trim();
                            bVal = b.cells[0].textContent.trim();
                            break;
                        case 'sales24':
                            aVal = parseFloat(a.dataset.sales24) || 0;
                            bVal = parseFloat(b.dataset.sales24) || 0;
                            break;
                        case 'sales25':
                            aVal = parseFloat(a.dataset.sales25) || 0;
                            bVal = parseFloat(b.dataset.sales25) || 0;
                            break;
                        case 'growth':
                            aVal = parseFloat(a.dataset.growth) || 0;
                            bVal = parseFloat(b.dataset.growth) || 0;
                            break;
                        case 'qty24':
                            aVal = parseFloat(a.dataset.qty24) || 0;
                            bVal = parseFloat(b.dataset.qty24) || 0;
                            break;
                        case 'qty25':
                            aVal = parseFloat(a.dataset.qty25) || 0;
                            bVal = parseFloat(b.dataset.qty25) || 0;
                            break;
                        case 'rate24':
                            aVal = parseFloat(a.dataset.rate24) || 0;
                            bVal = parseFloat(b.dataset.rate24) || 0;
                            break;
                        case 'rate25':
                            aVal = parseFloat(a.dataset.rate25) || 0;
                            bVal = parseFloat(b.dataset.rate25) || 0;
                            break;
                        case 'ratechange':
                            aVal = parseFloat(a.dataset.ratechange) || 0;
                            bVal = parseFloat(b.dataset.ratechange) || 0;
                            break;
                        case 'intag24':
                            aVal = parseFloat(a.dataset.intag24) || 0;
                            bVal = parseFloat(b.dataset.intag24) || 0;
                            break;
                        case 'intag25':
                            aVal = parseFloat(a.dataset.intag25) || 0;
                            bVal = parseFloat(b.dataset.intag25) || 0;
                            break;
                    }
                    if (typeof aVal === 'string') {
                        return isAsc ? bVal.localeCompare(aVal) : aVal.localeCompare(bVal);
                    }
                    return isAsc ? bVal - aVal : aVal - bVal;
                });
                
                rows.forEach(row => tbody.appendChild(row));
            });
        });
        
        // Women Down 접기/펴기
        function toggleDetail() {
            const tables = document.getElementById('detailTables');
            const header = document.querySelector('.detail-header');
            tables.classList.toggle('collapsed');
            header.classList.toggle('collapsed');
        }
        
        // 맨 위로 버튼
        const scrollBtn = document.getElementById('scrollTopBtn');
        window.addEventListener('scroll', function() {
            if (window.scrollY > 300) {
                scrollBtn.classList.add('visible');
            } else {
                scrollBtn.classList.remove('visible');
            }
        });
        
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // KPI 카운트업 애니메이션
        function animateValue(element, start, end, duration, suffix = '') {
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                const easeProgress = 1 - Math.pow(1 - progress, 3); // easeOutCubic
                const current = Math.floor(easeProgress * (end - start) + start);
                element.textContent = current.toLocaleString() + suffix;
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            window.requestAnimationFrame(step);
        }
        
        // 페이지 로드 시 KPI 애니메이션 실행
        document.addEventListener('DOMContentLoaded', function() {
            const kpiValues = document.querySelectorAll('.kpi-card .value');
            kpiValues.forEach(el => {
                const text = el.textContent;
                if (text.includes('M')) {
                    const num = parseInt(text.replace(/[^0-9]/g, ''));
                    el.textContent = '0M';
                    setTimeout(() => animateValue(el, 0, num, 1500, 'M'), 300);
                } else if (text.includes('%')) {
                    const num = parseFloat(text);
                    el.textContent = '0%';
                    setTimeout(() => {
                        animateValue(el, 0, Math.floor(num), 1500, '');
                        setTimeout(() => el.textContent = num.toFixed(1) + '%', 1500);
                    }, 300);
                }
            });
            
            // Golden Zone 데이터 로드
            loadGoldenZone();
            
            // 급상승 상품 데이터 로드
            loadTrendingProducts();
            
            // TOP 10 판매율 제품 데이터 로드
            loadBestSellRate();
            
            // TOP 10 매출 제품 데이터 로드
            loadBestProducts();
            
            // KPI 요약 데이터 로드
            loadKpiSummary();
            
            // 주차별 매출 차트 로드
            loadWeeklySalesChart();
            
            // 카테고리 매출 분석 로드
            loadCategorySummary();
            
            // Women Down 상세 분석 로드
            loadWomenDownDetail();
            
            // 카테고리별 BEST 상품 로드 (누적)
            loadWomenOuterBest();
            loadWomenTopBest();
            loadWomenBottomBest();
            loadMenDownBest();
            loadMenOuterBest();
            loadMenTopBest();
            loadMenBottomBest();
            loadAccBest();
            loadShoesBest();
            
            // 주간 BEST 상품 로드
            loadWeeklyWomenDownBest();
            loadWeeklyWomenOuterBest();
            loadWeeklyWomenTopBest();
            loadWeeklyWomenBottomBest();
            loadWeeklyMenDownBest();
            loadWeeklyMenOuterBest();
            loadWeeklyMenTopBest();
            loadWeeklyMenBottomBest();
            loadWeeklyAccBest();
            loadWeeklyShoesBest();
            
            // 누적 BEST 섹션 접기/펼치기
            document.getElementById('toggleCumulativeBest').addEventListener('click', function() {
                const content = document.getElementById('cumulativeBestContent');
                const btn = this;
                
                if (content.style.display === 'none') {
                    content.style.display = 'grid';
                    btn.textContent = '접기 ▲';
                } else {
                    content.style.display = 'none';
                    btn.textContent = '펼치기 ▼';
                }
            });
            
            // 주간 BEST 섹션 접기/펼치기
            document.getElementById('toggleWeeklyBest').addEventListener('click', function() {
                const content = document.getElementById('weeklyBestContent');
                const btn = this;
                
                if (content.style.display === 'none') {
                    content.style.display = 'grid';
                    btn.textContent = '접기 ▲';
                } else {
                    content.style.display = 'none';
                    btn.textContent = '펼치기 ▼';
                }
            });
        });
        
        // 카테고리별 BEST 상품 공통 로드 함수 (테이블 형식)
        async function loadCategoryBestTable(csvFile, tbodyId) {
            try {
                const response = await fetch(csvFile);
                if (!response.ok) {
                    throw new Error('HTTP error: ' + response.status);
                }
                const csvText = await response.text();
                const rows = csvText.trim().split('\n');
                
                if (rows.length < 2) {
                    throw new Error('CSV 데이터가 비어있음');
                }
                
                // CSV 컬럼: rank,style_name,gender,category,fabric,length,downweight,sell_amount,sell_qty
                // 인덱스:    0     1          2      3        4      5      6          7            8
                const data = rows.slice(1).map(row => {
                    const values = row.split(',');
                    return {
                        rank: parseInt(values[0]) || 0,
                        styleName: values[1] || '',
                        gender: values[2] || '',
                        category: values[3] || '',
                        fabric: values[4] || '-',
                        length: values[5] || '-',
                        downweight: values[6] || '-',
                        sellAmount: parseFloat(values[7]) || 0,
                        sellQty: parseInt(values[8]) || 0
                    };
                });
                
                // 디버깅: 첫 번째 행 데이터 출력
                if (data.length > 0) {
                    console.log(`📊 ${csvFile} 첫 번째 행:`, data[0]);
                    console.log(`   매출액: ${data[0].sellAmount}, 판매수량: ${data[0].sellQty}`);
                }
                
                renderCategoryBestTable(data, tbodyId);
                console.log(`✅ ${csvFile} 로드 완료 (${data.length}개 행)`);
            } catch (error) {
                console.error(`❌ ${csvFile} 로드 실패:`, error.message);
                document.getElementById(tbodyId).innerHTML = '<tr><td colspan="4" style="text-align:center; padding:20px; color:#e74c3c;">데이터 로딩 실패</td></tr>';
            }
        }
        
        // 카테고리별 BEST 상품 테이블 렌더링
        function renderCategoryBestTable(data, tbodyId) {
            const tbody = document.getElementById(tbodyId);
            if (!tbody) return;
            
            let html = '';
            
            data.forEach(item => {
                // 순위 표시 (1~3위 메달, 4위 이후 숫자)
                let rankDisplay = '';
                if (item.rank === 1) rankDisplay = '🥇';
                else if (item.rank === 2) rankDisplay = '🥈';
                else if (item.rank === 3) rankDisplay = '🥉';
                else rankDisplay = item.rank;
                
                // 매출액 (백만원 단위, 소수점 1자리)
                const salesM = (item.sellAmount / 1000000).toFixed(1);
                
                // 판매수량
                const salesQty = item.sellQty || 0;
                
                html += `
                    <tr>
                        <td class="rank-cell">${rankDisplay}</td>
                        <td class="name-cell" title="${item.styleName}">${item.styleName}</td>
                        <td class="sales-cell">${salesM}</td>
                        <td class="qty-cell">${salesQty}</td>
                    </tr>
                `;
            });
            
            tbody.innerHTML = html;
        }
        
        // 각 카테고리별 로드 함수
        function loadWomenOuterBest() {
            loadCategoryBestTable('women_outer_best.csv', 'womenOuterBestBody');
        }
        
        function loadWomenTopBest() {
            loadCategoryBestTable('women_top_best.csv', 'womenTopBestBody');
        }
        
        function loadWomenBottomBest() {
            loadCategoryBestTable('women_bottom_best.csv', 'womenBottomBestBody');
        }
        
        function loadMenDownBest() {
            loadCategoryBestTable('men_down_best.csv', 'menDownBestBody');
        }
        
        function loadMenOuterBest() {
            loadCategoryBestTable('men_outer_best.csv', 'menOuterBestBody');
        }
        
        function loadMenTopBest() {
            loadCategoryBestTable('men_top_best.csv', 'menTopBestBody');
        }
        
        function loadMenBottomBest() {
            loadCategoryBestTable('men_bottom_best.csv', 'menBottomBestBody');
        }
        
        function loadAccBest() {
            loadCategoryBestTable('acc_best.csv', 'accBestBody');
        }
        
        function loadShoesBest() {
            loadCategoryBestTable('shoes_best.csv', 'shoesBestBody');
        }
        
        // 주간 BEST 상품 공통 로드 함수
        async function loadWeeklyBestTable(csvFile, tbodyId, categoryName) {
            console.log(`📂 주간 BEST 로드 시작: ${csvFile}`);
            
            try {
                const response = await fetch(csvFile);
                console.log(`   응답 상태: ${response.status} (${csvFile})`);
                
                if (!response.ok) {
                    throw new Error('HTTP error: ' + response.status);
                }
                
                const csvText = await response.text();
                const rows = csvText.trim().split('\n');
                
                // 헤더만 있는 경우 (데이터 없음)
                if (rows.length < 2) {
                    console.log(`   ⚠️ ${categoryName}: 데이터 없음 (헤더만 존재)`);
                    document.getElementById(tbodyId).innerHTML = '<tr><td colspan="4" style="text-align:center; color:#999; font-size:0.7rem; padding:12px;">이번 주 데이터 없음</td></tr>';
                    return;
                }
                
                // CSV 컬럼: rank,style_name,sell_amount,sell_qty
                const data = rows.slice(1).map(row => {
                    const values = row.split(',');
                    return {
                        rank: parseInt(values[0]) || 0,
                        styleName: values[1] || '',
                        sellAmount: parseFloat(values[2]) || 0,
                        sellQty: parseInt(values[3]) || 0
                    };
                }).filter(item => item.styleName); // 빈 행 제거
                
                console.log(`   ✅ ${categoryName}: ${data.length}개 로드 완료`);
                if (data.length > 0) {
                    console.log(`      TOP 1: ${data[0].styleName} (매출: ${data[0].sellAmount})`);
                }
                
                renderWeeklyBestTable(data, tbodyId);
            } catch (error) {
                console.error(`   ❌ ${categoryName} 로드 실패:`, error.message);
                console.log(`      요청 경로: ${csvFile}`);
                document.getElementById(tbodyId).innerHTML = '<tr><td colspan="4" style="text-align:center; color:#999; font-size:0.7rem; padding:12px;">이번 주 데이터 없음</td></tr>';
            }
        }
        
        // 주간 BEST 테이블 렌더링
        function renderWeeklyBestTable(data, tbodyId) {
            const tbody = document.getElementById(tbodyId);
            if (!tbody) return;
            
            if (data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" style="text-align:center; color:#999; font-size:0.7rem; padding:12px;">이번 주 데이터 없음</td></tr>';
                return;
            }
            
            let html = '';
            
            data.forEach(item => {
                // 1위만 메달, 나머지 숫자
                const rankDisplay = item.rank === 1 ? '🥇' : item.rank;
                
                // 매출액 (백만원 단위)
                const salesM = (item.sellAmount / 1000000).toFixed(1);
                
                html += `
                    <tr>
                        <td class="rank-cell">${rankDisplay}</td>
                        <td class="name-cell" title="${item.styleName}">${item.styleName}</td>
                        <td class="sales-cell">${salesM}</td>
                        <td class="qty-cell">${item.sellQty}</td>
                    </tr>
                `;
            });
            
            tbody.innerHTML = html;
        }
        
        // 주간 BEST 개별 로드 함수
        function loadWeeklyWomenDownBest() {
            loadWeeklyBestTable('weekly_women_down_best.csv', 'weeklyWomenDownBody', '여성 DOWN');
        }
        
        function loadWeeklyWomenOuterBest() {
            loadWeeklyBestTable('weekly_women_outer_best.csv', 'weeklyWomenOuterBody', '여성 OUTER');
        }
        
        function loadWeeklyWomenTopBest() {
            loadWeeklyBestTable('weekly_women_top_best.csv', 'weeklyWomenTopBody', '여성 TOP');
        }
        
        function loadWeeklyWomenBottomBest() {
            loadWeeklyBestTable('weekly_women_bottom_best.csv', 'weeklyWomenBottomBody', '여성 BOTTOM');
        }
        
        function loadWeeklyMenDownBest() {
            loadWeeklyBestTable('weekly_men_down_best.csv', 'weeklyMenDownBody', '남성 DOWN');
        }
        
        function loadWeeklyMenOuterBest() {
            loadWeeklyBestTable('weekly_men_outer_best.csv', 'weeklyMenOuterBody', '남성 OUTER');
        }
        
        function loadWeeklyMenTopBest() {
            loadWeeklyBestTable('weekly_men_top_best.csv', 'weeklyMenTopBody', '남성 TOP');
        }
        
        function loadWeeklyMenBottomBest() {
            loadWeeklyBestTable('weekly_men_bottom_best.csv', 'weeklyMenBottomBody', '남성 BOTTOM');
        }
        
        function loadWeeklyAccBest() {
            loadWeeklyBestTable('weekly_acc_best.csv', 'weeklyAccBody', 'ACC');
        }
        
        function loadWeeklyShoesBest() {
            loadWeeklyBestTable('weekly_shoes_best.csv', 'weeklyShoesBody', 'SHOES');
        }
        
        // Golden Zone 인라인 데이터 (fetch 실패 시 폴백용)
        const goldenZoneData = [
            {rank:1,combination:'TEXTURED × MIDDLE × HEAVY',productCount24:0,productCount25:1,productCountChange:1,sell_amount_24:0,sell_amount_25:722.3,growth_rate:100.0,sell_rate_24:0.0,sell_rate_25:113.5,sell_rate_change:113.5,efficiency_score:456.52},
            {rank:2,combination:'TEXTURED × SHORT × HEAVY',productCount24:2,productCount25:4,productCountChange:2,sell_amount_24:105.5,sell_amount_25:540.9,growth_rate:412.6,sell_rate_24:36.7,sell_rate_25:26.3,sell_rate_change:-10.4,efficiency_score:296.36},
            {rank:3,combination:'TEXTURED × MIDDLE × LIGHT',productCount24:1,productCount25:1,productCountChange:0,sell_amount_24:89.8,sell_amount_25:351.4,growth_rate:291.2,sell_rate_24:92.5,sell_rate_25:85.3,sell_rate_change:-7.2,efficiency_score:217.21},
            {rank:4,combination:'SOFT-MATTE × MIDDLE × LIGHT',productCount24:0,productCount25:3,productCountChange:3,sell_amount_24:0,sell_amount_25:348.5,growth_rate:100.0,sell_rate_24:0.0,sell_rate_25:42.6,sell_rate_change:42.6,efficiency_score:214.72},
            {rank:5,combination:'SOFT-MATTE × SHORT × HEAVY',productCount24:2,productCount25:2,productCountChange:0,sell_amount_24:12.8,sell_amount_25:104.8,growth_rate:719.6,sell_rate_24:5.4,sell_rate_25:12.6,sell_rate_change:7.3,efficiency_score:196.91},
            {rank:6,combination:'SHINY × LONG × MEDIUM',productCount24:3,productCount25:2,productCountChange:-1,sell_amount_24:202.6,sell_amount_25:375.7,growth_rate:85.4,sell_rate_24:17.9,sell_rate_25:25.5,sell_rate_change:7.6,efficiency_score:182.61},
            {rank:7,combination:'SOFT-MATTE × LONG × HEAVY',productCount24:0,productCount25:4,productCountChange:4,sell_amount_24:0,sell_amount_25:331.2,growth_rate:100.0,sell_rate_24:0.0,sell_rate_25:16.3,sell_rate_change:16.3,efficiency_score:173.61},
            {rank:8,combination:'SOFT-MATTE × SHORT × LIGHT',productCount24:0,productCount25:3,productCountChange:3,sell_amount_24:0,sell_amount_25:192.7,growth_rate:100.0,sell_rate_24:0.0,sell_rate_25:39.9,sell_rate_change:39.9,efficiency_score:148.99},
            {rank:9,combination:'SHINY × MIDDLE × HEAVY',productCount24:1,productCount25:2,productCountChange:1,sell_amount_24:61.7,sell_amount_25:202.0,growth_rate:227.5,sell_rate_24:15.2,sell_rate_25:23.6,sell_rate_change:8.4,efficiency_score:141.81},
            {rank:10,combination:'SEMI-SHINY × MIDDLE × LIGHT',productCount24:1,productCount25:1,productCountChange:0,sell_amount_24:41.2,sell_amount_25:116.6,growth_rate:183.1,sell_rate_24:32.0,sell_rate_25:41.8,sell_rate_change:9.8,efficiency_score:105.53}
        ];
        
        // Golden Zone CSV 로드 및 렌더링
        async function loadGoldenZone() {
            try {
                const response = await fetch('golden_zone.csv');
                if (!response.ok) {
                    throw new Error('HTTP error: ' + response.status);
                }
                const csvText = await response.text();
                console.log('Golden Zone CSV 로드 성공');
                
                const rows = csvText.trim().split('\n');
                if (rows.length < 2) {
                    throw new Error('CSV 데이터가 비어있음');
                }
                
                // CSV 컬럼: rank,combination,fabric,length,downweight,product_count_24,product_count_25,product_count_change,sell_amount_24,sell_amount_25,growth_rate,sell_rate_24,sell_rate_25,sell_rate_change,efficiency_score
                const data = rows.slice(1).map(row => {
                    const values = row.split(',');
                    return {
                        rank: parseInt(values[0]) || 0,
                        combination: values[1] || '',
                        productCount24: parseInt(values[5]) || 0,
                        productCount25: parseInt(values[6]) || 0,
                        productCountChange: parseInt(values[7]) || 0,
                        sell_amount_24: parseFloat(values[8]) || 0,
                        sell_amount_25: parseFloat(values[9]) || 0,
                        growth_rate: parseFloat(values[10]) || 0,
                        sell_rate_24: parseFloat(values[11]) || 0,
                        sell_rate_25: parseFloat(values[12]) || 0,
                        sell_rate_change: parseFloat(values[13]) || 0,
                        efficiency_score: parseFloat(values[14]) || 0
                    };
                });
                
                console.log('Golden Zone 파싱 완료:', data.length + '개 행');
                renderGoldenZone(data);
                generateGoldenZoneInsights(data);
            } catch (error) {
                console.error('Golden Zone CSV 로드 실패, 인라인 데이터 사용:', error.message);
                renderGoldenZone(goldenZoneData);
                generateGoldenZoneInsights(goldenZoneData);
            }
        }
        
        function renderGoldenZone(data) {
            const tbody = document.getElementById('goldenZoneBody');
            if (!tbody) {
                console.error('goldenZoneBody 요소를 찾을 수 없음');
                return;
            }
            
            let html = '';
            
            data.forEach((row, idx) => {
                const rank = row.rank || (idx + 1);
                let rowClasses = [];
                let rankIcon = rank;
                
                // 순위별 클래스
                if (rank === 1) { rowClasses.push('rank-1'); rankIcon = '🥇'; }
                else if (rank === 2) { rowClasses.push('rank-2'); rankIcon = '🥈'; }
                else if (rank === 3) { rowClasses.push('rank-3'); rankIcon = '🥉'; }
                
                // 효율 점수 150 이상이면 high-efficiency
                if (row.efficiency_score >= 150) {
                    rowClasses.push('high-efficiency');
                }
                
                // 성장률 색상
                const growthClass = row.growth_rate > 0 ? 'positive' : (row.growth_rate < 0 ? 'negative' : 'neutral');
                const growthPrefix = row.growth_rate > 0 ? '+' : '';
                
                // 판매율 30% 이상이면 굵게
                const rate24Class = row.sell_rate_24 >= 30 ? 'high-rate' : '';
                const rate25Class = row.sell_rate_25 >= 30 ? 'high-rate' : '';
                
                // 판매율 변화 색상
                const rateChangeClass = row.sell_rate_change >= 0 ? 'positive' : 'negative';
                const rateChangePrefix = row.sell_rate_change >= 0 ? '+' : '';
                
                // 상품 수 변화 색상
                const pcChangeColor = row.productCountChange > 0 ? '#2e7d32' : (row.productCountChange < 0 ? '#d32f2f' : '#666');
                const pcChangeSign = row.productCountChange > 0 ? '+' : '';
                
                // 매출 포맷 (이미 백만원 단위로 저장됨)
                const sales24M = row.sell_amount_24.toLocaleString();
                const sales25M = row.sell_amount_25.toLocaleString();
                
                html += `
                <tr class="${rowClasses.join(' ')}">
                    <td style="text-align:center; font-size:1.1rem;">${rankIcon}</td>
                    <td class="combo-cell">${row.combination}</td>
                    <td class="product-count-24">${row.productCount24}개</td>
                    <td class="product-count-25">${row.productCount25}개</td>
                    <td style="color:${pcChangeColor}; font-weight:bold;">${pcChangeSign}${row.productCountChange}</td>
                    <td style="text-align:right;">${sales24M}</td>
                    <td style="text-align:right; font-weight:bold;">${sales25M}</td>
                    <td class="number-cell ${growthClass}">${growthPrefix}${row.growth_rate.toFixed(1)}%</td>
                    <td style="text-align:right;" class="${rate24Class}">${row.sell_rate_24.toFixed(1)}%</td>
                    <td style="text-align:right; font-weight:bold;" class="${rate25Class}">${row.sell_rate_25.toFixed(1)}%</td>
                    <td class="number-cell ${rateChangeClass}">${rateChangePrefix}${row.sell_rate_change.toFixed(1)}%p</td>
                    <td class="score-cell" style="text-align:right;">${row.efficiency_score.toFixed(1)}</td>
                </tr>`;
            });
            
            tbody.innerHTML = html;
            console.log('Golden Zone 테이블 렌더링 완료');
        }
        
        // Golden Zone AI 인사이트 생성 (깔끔한 전문적 스타일)
        function generateGoldenZoneInsights(data) {
            const insightsDiv = document.getElementById('goldenZoneInsights');
            if (!insightsDiv || data.length === 0) return;
            
            const top1 = data[0];
            const top3 = data.slice(0, 3);
            
            // 총 상품 수 (24FW vs 25FW)
            const totalProducts24 = data.reduce((sum, item) => sum + item.productCount24, 0);
            const totalProducts25 = data.reduce((sum, item) => sum + item.productCount25, 0);
            const totalProductChange = totalProducts25 - totalProducts24;
            
            // TOP 3 매출 비중
            const top3Sales = top3.reduce((sum, item) => sum + item.sell_amount_25, 0);
            const totalSales = data.reduce((sum, item) => sum + item.sell_amount_25, 0);
            const top3Share = totalSales > 0 ? ((top3Sales / totalSales) * 100).toFixed(1) : 0;
            
            // 1위 조합 상품당 평균 매출
            const salesPerProduct = top1.productCount25 > 0 ? 
                (top1.sell_amount_25 / top1.productCount25).toFixed(1) : 0;
            
            // 신제품 추가 조합 (상품 수 증가)
            const newProductCombos = data.filter(item => item.productCountChange > 0);
            const newProductSales = newProductCombos.reduce((sum, item) => sum + item.sell_amount_25, 0);
            
            // 효율 개선 조합 (상품 수 유지/감소 but 매출 증가)
            const efficientCombos = data.filter(item => 
                item.productCountChange <= 0 && item.growth_rate > 50
            );
            
            // 인사이트 HTML 생성 (깔끔한 표현)
            let insights = `
                <p><strong>최고 효율 조합</strong>: ${top1.combination} 
                   (효율 점수 <span class="insight-highlight">${top1.efficiency_score}</span>, 
                   상품 수 24FW ${top1.productCount24}개 → 25FW ${top1.productCount25}개, 
                   매출 <span class="insight-highlight">${top1.sell_amount_25.toLocaleString()}백만원</span>)</p>
            `;
            
            // 상품당 평균 매출
            if (top1.productCount25 > 0) {
                insights += `
                    <p><strong>상품당 평균 매출</strong>: 
                       <span class="insight-highlight">${salesPerProduct}백만원/개</span> 
                       (${top1.productCount25}개 제품으로 ${top1.sell_amount_25.toLocaleString()}백만원 달성)</p>
                `;
            }
            
            // TOP 3 비중
            insights += `
                <p><strong>상위 3개 조합 집중도</strong>: 
                   전체 매출의 <span class="insight-highlight">${top3Share}%</span> 차지 
                   (${top3Sales.toLocaleString()}백만원 / ${totalSales.toLocaleString()}백만원)</p>
            `;
            
            // 구분선
            insights += `<div class="insight-divider"></div>`;
            
            // 상품 구성 변화 분석
            insights += `
                <p><strong>전체 상품 구성</strong>: 
                   24FW ${totalProducts24}개에서 25FW ${totalProducts25}개로 
                   ${totalProductChange >= 0 ? '증가' : '감소'} 
                   (<span class="insight-highlight">${totalProductChange >= 0 ? '+' : ''}${totalProductChange}개</span>)</p>
            `;
            
            // 신제품 추가 조합 분석
            if (newProductCombos.length > 0) {
                insights += `
                    <p><strong>신제품 투입 조합</strong>: 
                       ${newProductCombos.length}개 조합에서 신제품 추가 
                       (해당 매출 ${newProductSales.toLocaleString()}백만원, 전체의 ${totalSales > 0 ? ((newProductSales/totalSales)*100).toFixed(1) : 0}%)</p>
                `;
            }
            
            // 효율 개선 조합
            if (efficientCombos.length > 0) {
                insights += `
                    <p><strong>효율 개선 조합</strong>: 
                       ${efficientCombos.length}개 조합이 상품 수 유지/감소 상태에서 매출 50% 이상 성장</p>
                `;
            }
            
            // 구분선
            insights += `<div class="insight-divider"></div>`;
            
            // 전략적 제안
            if (top1.productCountChange > 0) {
                insights += `
                    <p><strong>권장 전략</strong>: 
                       1위 조합(${top1.combination})에 신제품 ${top1.productCountChange}개 추가로 매출 급증 
                       → 동일 조합 추가 신제품 개발 검토</p>
                `;
            } else if (top1.productCountChange === 0 && top1.growth_rate > 100) {
                insights += `
                    <p><strong>권장 전략</strong>: 
                       1위 조합은 상품 수 변화 없이 매출 ${top1.growth_rate.toFixed(1)}% 성장 
                       → 기존 제품 최적화 성공, 물량 확대 검토</p>
                `;
            } else if (top1.productCount25 < 3) {
                insights += `
                    <p><strong>권장 전략</strong>: 
                       1위 조합 상품 수 ${top1.productCount25}개로 소수 
                       → 신제품 추가 개발 시 매출 확대 잠재력 높음</p>
                `;
            }
            
            insightsDiv.innerHTML = insights;
            console.log('Golden Zone AI 인사이트 생성 완료');
        }
        
        // Women Down 상세 분석 CSV 로드 및 렌더링
        async function loadWomenDownDetail() {
            try {
                const response = await fetch('women_down_detail.csv');
                if (!response.ok) {
                    throw new Error('women_down_detail.csv 로딩 실패: ' + response.status);
                }
                
                const csvText = await response.text();
                const lines = csvText.trim().split('\n');
                
                // CSV 파싱: attribute_type,attribute_value,sales_24,sales_25,growth_rate,sell_rate_24,sell_rate_25
                const data = { fabric: [], length: [], downweight: [] };
                
                for (let i = 1; i < lines.length; i++) {
                    const cols = lines[i].split(',');
                    const type = cols[0].trim();
                    const item = {
                        value: cols[1].trim(),
                        sales_24: parseFloat(cols[2]) || 0,
                        sales_25: parseFloat(cols[3]) || 0,
                        growth_rate: parseFloat(cols[4]) || 0,
                        sell_rate_24: parseFloat(cols[5]) || 0,
                        sell_rate_25: parseFloat(cols[6]) || 0
                    };
                    item.sell_rate_change = item.sell_rate_25 - item.sell_rate_24;
                    
                    if (data[type]) {
                        data[type].push(item);
                    }
                }
                
                // 각 속성별 테이블 및 인사이트 렌더링
                renderWomenDownTable('fabric', data.fabric, 'fabricTableBody', 'fabricInsights');
                renderWomenDownTable('length', data.length, 'lengthTableBody', 'lengthInsights');
                renderWomenDownTable('downweight', data.downweight, 'downweightTableBody', 'downweightInsights');
                
                console.log('✅ Women Down 상세 분석 로딩 완료');
                
            } catch (error) {
                console.error('❌ Women Down 상세 분석 로딩 실패:', error);
                ['fabricTableBody', 'lengthTableBody', 'downweightTableBody'].forEach(id => {
                    const el = document.getElementById(id);
                    if (el) el.innerHTML = '<tr><td colspan="7" style="text-align:center; color:#e74c3c;">데이터 로딩 실패</td></tr>';
                });
            }
        }
        
        // Women Down 테이블 렌더링 함수
        function renderWomenDownTable(type, items, tbodyId, insightsId) {
            const tbody = document.getElementById(tbodyId);
            const insightsEl = document.getElementById(insightsId);
            
            if (!tbody || !insightsEl || items.length === 0) return;
            
            // 25FW 매출 합계 계산 (비중 계산용)
            const totalSales25 = items.reduce((sum, item) => sum + item.sales_25, 0);
            
            // 매출 기준 정렬
            const sortedItems = [...items].sort((a, b) => b.sales_25 - a.sales_25);
            
            // 테이블 렌더링
            tbody.innerHTML = '';
            sortedItems.forEach(item => {
                const salesPercent = totalSales25 > 0 ? (item.sales_25 / totalSales25 * 100) : 0;
                const growthClass = item.growth_rate >= 0 ? 'positive' : 'negative';
                const changeClass = item.sell_rate_change >= 0 ? 'efficiency-high' : 'efficiency-low';
                const changeIcon = item.sell_rate_change >= 0 ? '✅' : '⚠️';
                
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><strong>${item.value}</strong></td>
                    <td>${Math.round(item.sales_24 / 1000000).toLocaleString()}</td>
                    <td>${Math.round(item.sales_25 / 1000000).toLocaleString()}</td>
                    <td class="${growthClass}">${item.growth_rate >= 0 ? '+' : ''}${item.growth_rate.toFixed(1)}%</td>
                    <td>${item.sell_rate_24.toFixed(1)}%</td>
                    <td>${item.sell_rate_25.toFixed(1)}%</td>
                    <td class="${changeClass}">${item.sell_rate_change >= 0 ? '+' : ''}${item.sell_rate_change.toFixed(1)}%p ${changeIcon}</td>
                `;
                tbody.appendChild(tr);
            });
            
            // AI 인사이트 생성
            generateWomenDownInsights(type, sortedItems, insightsEl);
        }
        
        // Women Down AI 인사이트 생성
        function generateWomenDownInsights(type, items, container) {
            const positiveInsights = [];
            const warningInsights = [];
            
            // 매출 1위
            const topItem = items[0];
            if (topItem) {
                positiveInsights.push(`✅ <strong>${topItem.value}</strong> 매출 1위 (${Math.round(topItem.sales_25 / 1000000).toLocaleString()}백만원)`);
            }
            
            // 성장률 TOP (100% 이상)
            const highGrowth = items.filter(i => i.growth_rate > 100).sort((a, b) => b.growth_rate - a.growth_rate);
            highGrowth.slice(0, 2).forEach(item => {
                if (item !== topItem) {
                    positiveInsights.push(`💡 <strong>${item.value}</strong> 급성장 (+${item.growth_rate.toFixed(1)}%) - 성장 모멘텀 확보`);
                }
            });
            
            // 판매율 개선 TOP
            const rateImproved = items.filter(i => i.sell_rate_change > 5).sort((a, b) => b.sell_rate_change - a.sell_rate_change);
            rateImproved.slice(0, 1).forEach(item => {
                positiveInsights.push(`✅ <strong>${item.value}</strong> 판매율 대폭 개선 (<span class="positive">+${item.sell_rate_change.toFixed(1)}%p</span>)`);
            });
            
            // 매출 하락
            const declining = items.filter(i => i.growth_rate < -20).sort((a, b) => a.growth_rate - b.growth_rate);
            declining.forEach(item => {
                warningInsights.push(`🚨 <strong>${item.value}</strong> 매출 하락 (${item.growth_rate.toFixed(1)}%) - 원인 분석 필요`);
            });
            
            // 판매율 하락
            const rateDeclining = items.filter(i => i.sell_rate_change < -5).sort((a, b) => a.sell_rate_change - b.sell_rate_change);
            rateDeclining.slice(0, 2).forEach(item => {
                warningInsights.push(`⚠️ <strong>${item.value}</strong> 판매율 하락 (<span class="negative">${item.sell_rate_change.toFixed(1)}%p</span>) - 재고 관리 주의`);
            });
            
            // HTML 렌더링
            let html = '<div class="insights-positive">';
            positiveInsights.forEach(p => { html += `<p>${p}</p>`; });
            html += '</div>';
            
            if (warningInsights.length > 0) {
                html += '<div class="insights-warnings">';
                warningInsights.forEach(p => { html += `<p class="warning">${p}</p>`; });
                html += '</div>';
            }
            
            container.innerHTML = html;
        }
        
        // 카테고리 매출 분석 CSV 로드 및 렌더링 (완전 재작성)
        async function loadCategorySummary() {
            try {
                const response = await fetch('category_summary.csv');
                if (!response.ok) {
                    throw new Error('category_summary.csv 로딩 실패: ' + response.status);
                }
                
                const csvText = await response.text();
                const lines = csvText.trim().split('\n');
                
                // CSV 파싱
                // 구조: category,sales_24,sales_25,sales_growth,qty_24,qty_25,qty_change,in_tag_24,in_tag_25,in_tag_growth,sell_rate_24,sell_rate_25,sell_rate_change
                const data = {};
                for (let i = 1; i < lines.length; i++) {
                    const cols = lines[i].split(',');
                    const category = cols[0].trim();
                    data[category] = {
                        sales_24: parseFloat(cols[1]) || 0,
                        sales_25: parseFloat(cols[2]) || 0,
                        sales_growth: parseFloat(cols[3]) || 0,
                        qty_24: parseInt(cols[4]) || 0,
                        qty_25: parseInt(cols[5]) || 0,
                        qty_change: parseInt(cols[6]) || 0,
                        in_tag_24: parseFloat(cols[7]) || 0,
                        in_tag_25: parseFloat(cols[8]) || 0,
                        in_tag_growth: parseFloat(cols[9]) || 0,
                        sell_rate_24: parseFloat(cols[10]) || 0,
                        sell_rate_25: parseFloat(cols[11]) || 0,
                        sell_rate_change: parseFloat(cols[12]) || 0
                    };
                }
                
                // 행 설정 (카테고리, 표시명, CSS 클래스, 이모지)
                const rowConfig = [
                    { key: 'TOTAL', label: 'TOTAL', rowClass: 'row-total', emoji: '' },
                    { key: 'WOMEN', label: 'WOMEN', rowClass: 'row-women', emoji: '' },
                    { key: 'WOMEN_DOWN', label: 'DOWN', rowClass: 'row-women-sub', emoji: '🔻' },
                    { key: 'WOMEN_OUTER', label: 'OUTER', rowClass: 'row-women-sub', emoji: '🧥' },
                    { key: 'WOMEN_TOP', label: 'TOP', rowClass: 'row-women-sub', emoji: '👕' },
                    { key: 'WOMEN_BOTTOM', label: 'BOTTOM', rowClass: 'row-women-sub', emoji: '👖' },
                    { key: 'MEN', label: 'MEN', rowClass: 'row-men', emoji: '' },
                    { key: 'MEN_DOWN', label: 'DOWN', rowClass: 'row-men-sub', emoji: '🔻' },
                    { key: 'MEN_OUTER', label: 'OUTER', rowClass: 'row-men-sub', emoji: '🧥' },
                    { key: 'MEN_TOP', label: 'TOP', rowClass: 'row-men-sub', emoji: '👕' },
                    { key: 'MEN_BOTTOM', label: 'BOTTOM', rowClass: 'row-men-sub', emoji: '👖' },
                    { key: 'ACC', label: 'ACC', rowClass: 'row-acc', emoji: '' },
                    { key: 'SHOES', label: 'SHOES', rowClass: 'row-shoes', emoji: '' }
                ];
                
                // 포맷팅 함수
                const fmtMillion = (num) => Math.round(num / 1000000).toLocaleString();
                const fmtQty = (num) => num.toLocaleString();
                const fmtGrowth = (num) => (num >= 0 ? '+' : '') + num.toFixed(1) + '%';
                const fmtChange = (num) => (num >= 0 ? '+' : '') + num.toLocaleString();
                const fmtRate = (num) => num.toFixed(1) + '%';
                const fmtRateChange = (num) => (num >= 0 ? '+' : '') + num.toFixed(1) + '%p';
                
                // 숫자 색상 클래스
                const getNumClass = (num) => {
                    if (num > 0) return 'num-positive';
                    if (num < 0) return 'num-negative';
                    return 'num-zero';
                };
                
                // 테이블 생성
                const tbody = document.getElementById('categorySummaryTableBody');
                tbody.innerHTML = '';
                
                for (const config of rowConfig) {
                    const d = data[config.key];
                    if (!d) continue;
                    
                    // 카테고리명 (이모지 포함)
                    const catLabel = config.emoji 
                        ? `<span class="cat-emoji">${config.emoji}</span>${config.label}`
                        : `<span class="cat-name">${config.label}</span>`;
                    
                    const tr = document.createElement('tr');
                    tr.className = config.rowClass;
                    
                    tr.innerHTML = `
                        <td>${catLabel}</td>
                        <td class="num-cell">${fmtMillion(d.sales_24)}</td>
                        <td class="num-cell">${fmtMillion(d.sales_25)}</td>
                        <td class="num-cell ${getNumClass(d.sales_growth)}">${fmtGrowth(d.sales_growth)}</td>
                        <td class="num-cell">${fmtQty(d.qty_24)}</td>
                        <td class="num-cell">${fmtQty(d.qty_25)}</td>
                        <td class="num-cell ${getNumClass(d.qty_change)}">${fmtChange(d.qty_change)}</td>
                        <td class="num-cell">${fmtMillion(d.in_tag_24)}</td>
                        <td class="num-cell">${fmtMillion(d.in_tag_25)}</td>
                        <td class="num-cell ${getNumClass(d.in_tag_growth)}">${fmtGrowth(d.in_tag_growth)}</td>
                        <td class="num-cell">${fmtRate(d.sell_rate_24)}</td>
                        <td class="num-cell">${fmtRate(d.sell_rate_25)}</td>
                        <td class="num-cell ${getNumClass(d.sell_rate_change)}">${fmtRateChange(d.sell_rate_change)}</td>
                    `;
                    
                    tbody.appendChild(tr);
                }
                
                console.log('✅ 카테고리 매출 분석 로딩 완료');
                
            } catch (error) {
                console.error('❌ 카테고리 매출 분석 로딩 실패:', error);
                document.getElementById('categorySummaryTableBody').innerHTML = 
                    '<tr><td colspan="13" style="text-align:center; color:#e74c3c;">데이터 로딩 실패</td></tr>';
            }
        }
        
        // TOP 10 매출 제품 CSV 로드 및 렌더링
        async function loadBestProducts() {
            try {
                const response = await fetch('best_products.csv');
                if (!response.ok) {
                    throw new Error('best_products.csv 로딩 실패: ' + response.status);
                }
                
                const csvText = await response.text();
                const lines = csvText.trim().split('\n');
                
                const tbody = document.getElementById('bestProductsTableBody');
                tbody.innerHTML = '';
                
                // 데이터 행 파싱 (헤더 제외)
                // CSV 구조: rank,style_name,gender,category,fabric,length,downweight,sell_amount_m,sell_qty,sell_rate,stock_status
                for (let i = 1; i < lines.length && i <= 10; i++) {
                    const cols = lines[i].split(',');
                    
                    const rank = parseInt(cols[0]);
                    const styleName = cols[1];
                    const gender = cols[2];
                    const category = cols[3];
                    const fabric = cols[4];
                    const length = cols[5];
                    const downweight = cols[6];
                    const sellAmountM = parseFloat(cols[7]).toFixed(1);
                    const sellQty = parseInt(cols[8]);
                    
                    // 메달 아이콘
                    let medal = '';
                    let rankClass = '';
                    if (rank === 1) {
                        medal = '🥇';
                        rankClass = 'rank-1';
                    } else if (rank === 2) {
                        medal = '🥈';
                        rankClass = 'rank-2';
                    } else if (rank === 3) {
                        medal = '🥉';
                        rankClass = 'rank-3';
                    } else {
                        medal = rank;
                    }
                    
                    // 성별 배지
                    const genderBadge = gender === 'WOMEN' 
                        ? '<span class="gender-badge women">여성</span>'
                        : '<span class="gender-badge men">남성</span>';
                    
                    // Fabric × Length × Downweight 조합
                    const specText = `${fabric} × ${length} × ${downweight}`;
                    
                    const tr = `
                        <tr class="${rankClass}">
                            <td class="rank-cell">${medal}</td>
                            <td class="product-name">${styleName}</td>
                            <td>${genderBadge}</td>
                            <td><span class="category-badge">${category}</span></td>
                            <td class="spec-cell">${specText}</td>
                            <td class="number-cell">${sellAmountM}</td>
                            <td class="number-cell">${sellQty}</td>
                        </tr>
                    `;
                    
                    tbody.innerHTML += tr;
                }
                
                console.log('✅ TOP 10 매출 제품 로딩 완료');
                
            } catch (error) {
                console.error('❌ TOP 10 매출 제품 로딩 실패:', error);
                document.getElementById('bestProductsTableBody').innerHTML = 
                    '<tr><td colspan="7" style="text-align:center; color:#e74c3c;">데이터 로딩 실패</td></tr>';
            }
        }
        
        // TOP 10 판매율 제품 CSV 로드 및 렌더링
        async function loadBestSellRate() {
            try {
                const response = await fetch('best_sell_rate.csv');
                if (!response.ok) {
                    throw new Error('best_sell_rate.csv 로딩 실패: ' + response.status);
                }
                
                const csvText = await response.text();
                const lines = csvText.trim().split('\n');
                
                const tbody = document.getElementById('bestSellRateTableBody');
                tbody.innerHTML = '';
                
                // 데이터 행 파싱 (헤더 제외)
                for (let i = 1; i < lines.length && i <= 10; i++) {
                    const cols = lines[i].split(',');
                    
                    // rank,style_name,gender,category,sell_rate,sell_amount_m,sell_qty,stock_status
                    const rank = parseInt(cols[0]);
                    const styleName = cols[1];
                    const sellRate = parseFloat(cols[4]).toFixed(1);
                    const stockStatus = cols[7] ? cols[7].trim() : '';
                    
                    // 메달 아이콘
                    let medal = '';
                    let rankClass = '';
                    if (rank === 1) {
                        medal = '🥇';
                        rankClass = 'rank-1';
                    } else if (rank === 2) {
                        medal = '🥈';
                        rankClass = 'rank-2';
                    } else if (rank === 3) {
                        medal = '🥉';
                        rankClass = 'rank-3';
                    } else {
                        medal = rank;
                    }
                    
                    // ✅ 재고 상태 - 재고부족만 표시
                    let statusBadge = '';
                    if (stockStatus === '재고부족') {
                        statusBadge = '<span class="badge badge-danger">재고부족</span>';
                    }
                    // 적정, 재고과다는 표시 안 함 (빈 칸)
                    
                    // ✅ 4개 컬럼만 생성 (순위, 제품명, 판매율, 상태)
                    const tr = `
                        <tr class="${rankClass}">
                            <td class="rank-cell">${medal}</td>
                            <td class="product-name">${styleName}</td>
                            <td class="number-cell rate-highlight">${sellRate}%</td>
                            <td class="status-cell">${statusBadge}</td>
                        </tr>
                    `;
                    
                    tbody.innerHTML += tr;
                }
                
                console.log('✅ TOP 10 판매율 제품 로딩 완료');
                
            } catch (error) {
                console.error('❌ TOP 10 판매율 제품 로딩 실패:', error);
                document.getElementById('bestSellRateTableBody').innerHTML = 
                    '<tr><td colspan="4" style="text-align:center; color:#e74c3c;">데이터 로딩 실패</td></tr>';
            }
        }
        
        // 급상승 상품 CSV 로드 및 렌더링
        async function loadTrendingProducts() {
            try {
                const response = await fetch('trending_products.csv');
                if (!response.ok) {
                    throw new Error('HTTP error: ' + response.status);
                }
                const csvText = await response.text();
                console.log('급상승 상품 CSV 로드 성공');
                
                const rows = csvText.trim().split('\n');
                if (rows.length < 2) {
                    throw new Error('CSV 데이터가 비어있음');
                }
                
                // CSV 컬럼: product_name, gender, category, prev_week_qty, latest_week_qty, growth_rate, cumulative_sell_rate, prev_week_range, latest_week_range
                const data = rows.slice(1).map(row => {
                    const values = row.split(',');
                    return {
                        product_name: values[0] || '',
                        gender: values[1] || '',
                        category: values[2] || '',
                        prev_week_qty: parseInt(values[3]) || 0,
                        latest_week_qty: parseInt(values[4]) || 0,
                        growth_rate: parseFloat(values[5]) || 0,
                        cumulative_sell_rate: parseFloat(values[6]) || 0,
                        prev_week_range: values[7] || '',
                        latest_week_range: values[8] || ''
                    };
                });
                
                console.log('급상승 상품 파싱 완료:', data.length + '개 행');
                renderTrendingProducts(data);
            } catch (error) {
                console.error('급상승 상품 데이터 로드 실패:', error.message);
                document.getElementById('trendingBody').innerHTML = 
                    '<tr><td colspan="8" style="text-align:center; padding:20px; color:#e74c3c;">데이터 로드 실패</td></tr>';
            }
        }
        
        function renderTrendingProducts(data) {
            const tbody = document.getElementById('trendingBody');
            
            if (!tbody) {
                console.error('급상승 상품 요소를 찾을 수 없음');
                return;
            }
            
            let html = '';
            
            data.forEach((row, idx) => {
                const rank = idx + 1;
                let rowClass = '';
                let rankIcon = rank;
                
                // 순위별 클래스 및 아이콘 (금/은/동 배경)
                if (rank === 1) { rowClass = 'rank-1'; rankIcon = '🥇'; }
                else if (rank === 2) { rowClass = 'rank-2'; rankIcon = '🥈'; }
                else if (rank === 3) { rowClass = 'rank-3'; rankIcon = '🥉'; }
                
                // 성별 표시 (WOMEN=여성, MEN=남성, ACC=악세서리, SHOES=슈즈)
                let genderText = row.gender;
                let genderClass = 'men';
                const genderUpper = row.gender.toUpperCase();
                if (genderUpper === 'WOMEN') { genderText = '여성'; genderClass = 'women'; }
                else if (genderUpper === 'MEN') { genderText = '남성'; genderClass = 'men'; }
                else if (genderUpper === 'ACC') { genderText = '악세서리'; genderClass = 'men'; }
                else if (genderUpper === 'SHOES') { genderText = '슈즈'; genderClass = 'men'; }
                
                // 전주 대비 증가율 스타일
                let growthStyle = '';
                let growthText = '';
                if (row.growth_rate > 0) {
                    growthStyle = 'color:#27ae60; font-weight:700;';  // 녹색 bold
                    growthText = '+' + row.growth_rate.toFixed(1) + '%';
                } else if (row.growth_rate < 0) {
                    growthStyle = 'color:#e74c3c; font-weight:700;';  // 빨강 bold
                    growthText = row.growth_rate.toFixed(1) + '%';
                } else {
                    growthStyle = 'color:#888;';  // 회색
                    growthText = '0.0%';
                }
                
                // 누적 판매율 스타일 및 재고 상태
                let sellRateStyle = '';
                let sellRateWarning = '';
                if (row.cumulative_sell_rate > 70) {
                    sellRateStyle = 'color:#e74c3c; font-weight:700;';
                    sellRateWarning = ' ⚠️재고부족';
                } else if (row.cumulative_sell_rate >= 50) {
                    sellRateStyle = 'color:#f39c12; font-weight:700;';
                    sellRateWarning = ' ⚠️재고주의';
                }
                
                html += `
                <tr class="${rowClass}">
                    <td class="rank-cell">${rankIcon}</td>
                    <td class="product-name">${row.product_name}</td>
                    <td><span class="gender-badge ${genderClass}">${genderText}</span></td>
                    <td><span class="category-badge">${row.category}</span></td>
                    <td class="number-cell" style="color:#888;">${row.prev_week_qty.toLocaleString()}</td>
                    <td class="number-cell" style="font-weight:700;">${row.latest_week_qty.toLocaleString()}</td>
                    <td class="number-cell" style="${growthStyle}">${growthText}</td>
                    <td class="number-cell" style="${sellRateStyle}">${row.cumulative_sell_rate.toFixed(1)}%${sellRateWarning}</td>
                </tr>`;
            });
            
            if (data.length === 0) {
                html = '<tr><td colspan="8" style="text-align:center; padding:20px;">급상승 상품 없음</td></tr>';
            }
            
            tbody.innerHTML = html;
            console.log('급상승 상품 테이블 렌더링 완료');
        }
        
        // KPI 요약 CSV 로드 및 렌더링 (통일된 포맷)
        async function loadKpiSummary() {
            try {
                const response = await fetch('kpi_summary.csv');
                if (!response.ok) {
                    throw new Error('HTTP error: ' + response.status);
                }
                const csvText = await response.text();
                console.log('KPI 요약 CSV 로드 성공');
                
                const rows = csvText.trim().split('\n');
                if (rows.length < 2) {
                    throw new Error('CSV 데이터가 비어있음');
                }
                
                const headers = rows[0].split(',');
                const values = rows[1].split(',');
                const data = {};
                headers.forEach((h, i) => {
                    data[h.trim()] = values[i] ? values[i].trim() : '';
                });
                
                renderKpiCards(data);
            } catch (error) {
                console.error('KPI 요약 데이터 로드 실패:', error.message);
                document.getElementById('kpiCards').innerHTML = '<div style="text-align:center; padding:40px; color:#d32f2f;">KPI 데이터 로드 실패</div>';
            }
        }
        
        function renderKpiCards(data) {
            // 포맷 헬퍼 함수
            const fmtM = (val) => Math.round(parseFloat(val) / 1000000).toLocaleString();
            const fmtR = (val) => parseFloat(val).toFixed(1);
            const fmtQ = (val) => parseInt(val).toLocaleString();
            const fmtG = (val, unit='%') => {
                const num = parseFloat(val);
                const sign = num >= 0 ? '+' : '';
                const arrow = num >= 0 ? '▲' : '▼';
                return `${arrow} ${sign}${num.toFixed(1)}${unit}`;
            };
            const fmtGp = (val) => {
                const num = parseFloat(val);
                const sign = num >= 0 ? '+' : '';
                return `${sign}${num.toFixed(1)}%p`;
            };
            const getClass = (val) => parseFloat(val) >= 0 ? 'positive' : 'negative';
            const getClassInv = (val) => parseFloat(val) <= 0 ? 'positive' : 'negative'; // 할인율용 (낮을수록 좋음)
            
            // 데이터 파싱
            const totalSales25 = parseFloat(data.total_sales_25 || 0);
            const totalSales24 = parseFloat(data.total_sales_24 || 0);
            const totalSalesGrowth = totalSales24 > 0 ? ((totalSales25 - totalSales24) / totalSales24 * 100) : 0;
            
            const totalRate25 = parseFloat(data.total_sell_rate_25 || 0);
            const totalRate24 = parseFloat(data.total_sell_rate_24 || 0);
            const totalRateChange = totalRate25 - totalRate24;
            
            const totalDiscount25 = parseFloat(data.discount_rate_25 || 0);
            const totalDiscount24 = parseFloat(data.discount_rate_24 || 0);
            const totalDiscountChange = totalDiscount25 - totalDiscount24;
            
            // WOMEN DOWN
            const wdSales25 = parseFloat(data.wd_sales_25 || 0);
            const wdSales24 = parseFloat(data.wd_sales_24 || 0);
            const wdSalesGrowth = wdSales24 > 0 ? ((wdSales25 - wdSales24) / wdSales24 * 100) : 0;
            
            const wdRate25 = parseFloat(data.wd_sell_rate_25 || 0);
            const wdRate24 = parseFloat(data.wd_sell_rate_24 || 0);
            const wdRateChange = wdRate25 - wdRate24;
            
            const wdDiscount25 = parseFloat(data.wd_discount_rate_25 || 0);
            const wdDiscount24 = parseFloat(data.wd_discount_rate_24 || 0);
            const wdDiscountChange = wdDiscount25 - wdDiscount24;
            
            const wdQty25 = parseInt(data.wd_sell_qty_25 || 0);
            const wdQty24 = parseInt(data.wd_sell_qty_24 || 0);
            const wdQtyGrowth = wdQty24 > 0 ? ((wdQty25 - wdQty24) / wdQty24 * 100) : 0;
            
            // 입고금액
            const inAmount25 = parseFloat(data.total_in_amount_25 || 0);
            const inAmount24 = parseFloat(data.total_in_amount_24 || 0);
            const inAmountGrowth = inAmount24 > 0 ? ((inAmount25 - inAmount24) / inAmount24 * 100) : 0;
            
            // 금주
            const latestWeek = data.latest_week_no_25 || '최신주차';
            const weekSales25 = parseFloat(data.week_sales_25 || 0);
            const weekSales24 = parseFloat(data.week_sales_24 || 0);
            const weekSalesGrowth = weekSales24 > 0 ? ((weekSales25 - weekSales24) / weekSales24 * 100) : 0;
            
            const weekDiscount25 = parseFloat(data.week_discount_rate_25 || 0);
            const weekDiscount24 = parseFloat(data.week_discount_rate_24 || 0);
            const weekDiscountChange = weekDiscount25 - weekDiscount24;
            
            // 금주 WD
            const weekWdSales25 = parseFloat(data.week_wd_sales_25 || 0);
            const weekWdSales24 = parseFloat(data.week_wd_sales_24 || 0);
            const weekWdSalesGrowth = weekWdSales24 > 0 ? ((weekWdSales25 - weekWdSales24) / weekWdSales24 * 100) : 0;
            
            const weekWdDiscount25 = parseFloat(data.week_wd_discount_rate_25 || 0);
            const weekWdDiscount24 = parseFloat(data.week_wd_discount_rate_24 || 0);
            const weekWdDiscountChange = weekWdDiscount25 - weekWdDiscount24;
            
            const weekWdQty25 = parseInt(data.week_wd_sell_qty_25 || 0);
            const weekWdQty24 = parseInt(data.week_wd_sell_qty_24 || 0);
            const weekWdQtyGrowth = weekWdQty24 > 0 ? ((weekWdQty25 - weekWdQty24) / weekWdQty24 * 100) : 0;
            
            // KPI 아이템 생성 헬퍼
            const createKpiItem = (label, value25, unit, value24, growth, isDiscount=false, fullWidth=false) => {
                const growthClass = isDiscount ? getClassInv(growth) : getClass(growth);
                const unitSuffix = unit === '%' ? '%p' : '%';
                const fwClass = fullWidth ? ' full-width' : '';
                return `
                    <div class="kpi-item${fwClass}">
                        <div class="kpi-label">${label}</div>
                        <div class="kpi-main">
                            <span class="kpi-value">${value25}</span>
                            <span class="unit">${unit}</span>
                        </div>
                        <div class="kpi-comparison">
                            <div class="comparison-label">vs 24FW</div>
                            <div class="comparison-value">${value24}${unit}</div>
                            <div class="comparison-growth ${growthClass}">${fmtG(growth, unitSuffix)}</div>
                        </div>
                    </div>
                `;
            };
            
            // HTML 생성
            const kpiCardsHTML = `
                <!-- Card 1: 25FW 누적 실적 -->
                <div class="kpi-card bg-blue animate-delay-1">
                    <div class="kpi-header">
                        <span class="kpi-icon">🔥</span>
                        <span class="kpi-title">25FW 누적 실적</span>
                    </div>
                    <div class="kpi-body">
                        ${createKpiItem('매출', fmtM(totalSales25), '백만원', fmtM(totalSales24), totalSalesGrowth)}
                        ${createKpiItem('판매율', fmtR(totalRate25), '%', fmtR(totalRate24), totalRateChange)}
                        ${createKpiItem('할인율', fmtR(totalDiscount25), '%', fmtR(totalDiscount24), totalDiscountChange, true)}
                    </div>
                </div>
                
                <!-- Card 2: WOMEN DOWN 누적 -->
                <div class="kpi-card bg-purple animate-delay-2">
                    <div class="kpi-header">
                        <span class="kpi-icon">👗</span>
                        <span class="kpi-title">WOMEN DOWN 누적</span>
                    </div>
                    <div class="kpi-body">
                        ${createKpiItem('매출', fmtM(wdSales25), '백만원', fmtM(wdSales24), wdSalesGrowth)}
                        ${createKpiItem('판매율', fmtR(wdRate25), '%', fmtR(wdRate24), wdRateChange)}
                        ${createKpiItem('할인율', fmtR(wdDiscount25), '%', fmtR(wdDiscount24), wdDiscountChange, true)}
                        ${createKpiItem('판매수량', fmtQ(wdQty25), '장', fmtQ(wdQty24), wdQtyGrowth)}
                    </div>
                </div>
                
                <!-- Card 3: 25FW 입고금액 -->
                <div class="kpi-card bg-teal animate-delay-3">
                    <div class="kpi-header">
                        <span class="kpi-icon">📦</span>
                        <span class="kpi-title">25FW 입고금액</span>
                    </div>
                    <div class="kpi-body">
                        ${createKpiItem('입고금액', fmtM(inAmount25), '백만원', fmtM(inAmount24), inAmountGrowth, false, true)}
                    </div>
                </div>
                
                <!-- Card 4: 금주 실적 -->
                <div class="kpi-card bg-green animate-delay-1">
                    <div class="kpi-header">
                        <span class="kpi-icon">📅</span>
                        <span class="kpi-title">금주(${latestWeek}) 실적</span>
                    </div>
                    <div class="kpi-body">
                        ${createKpiItem('매출', fmtM(weekSales25), '백만원', fmtM(weekSales24), weekSalesGrowth)}
                        ${createKpiItem('할인율', fmtR(weekDiscount25), '%', fmtR(weekDiscount24), weekDiscountChange, true)}
                    </div>
                </div>
                
                <!-- Card 5: 금주 WOMEN DOWN -->
                <div class="kpi-card bg-orange animate-delay-2">
                    <div class="kpi-header">
                        <span class="kpi-icon">📊</span>
                        <span class="kpi-title">금주(${latestWeek}) WD</span>
                    </div>
                    <div class="kpi-body">
                        ${createKpiItem('매출', fmtM(weekWdSales25), '백만원', fmtM(weekWdSales24), weekWdSalesGrowth)}
                        ${createKpiItem('할인율', fmtR(weekWdDiscount25), '%', fmtR(weekWdDiscount24), weekWdDiscountChange, true)}
                        ${createKpiItem('판매수량', fmtQ(weekWdQty25), '장', fmtQ(weekWdQty24), weekWdQtyGrowth)}
                    </div>
                </div>
                
                <!-- Card 6: 25FW 마감예상 (고정값) -->
                <div class="kpi-card bg-red animate-delay-3">
                    <div class="kpi-header">
                        <span class="kpi-icon">🎯</span>
                        <span class="kpi-title">25FW 마감예상</span>
                    </div>
                    <div class="kpi-body">
                        <div class="kpi-item">
                            <div class="kpi-label">매출</div>
                            <div class="kpi-main">
                                <span class="kpi-value">18,500</span>
                                <span class="unit">백만원</span>
                            </div>
                        </div>
                        <div class="kpi-item">
                            <div class="kpi-label">판매율</div>
                            <div class="kpi-main">
                                <span class="kpi-value">61.0</span>
                                <span class="unit">%</span>
                            </div>
                        </div>
                    </div>
                    <div class="kpi-footer">
                        <div class="kpi-note">시즌 종료 시점 예상치</div>
                    </div>
                </div>
            `;
            
            document.getElementById('kpiCards').innerHTML = kpiCardsHTML;
            console.log('KPI 카드 렌더링 완료 (통일된 포맷)');
            
            // AI 분석 생성 (KPI 데이터 기반)
            generateAIAnalysis(data);
        }
        
        // ============================================================
        // AI 분석 생성 함수
        // ============================================================
        // CSV 파싱 헬퍼 함수
        function parseCSV(csvText) {
            const lines = csvText.trim().split('\n');
            const headers = lines[0].split(',');
            return lines.slice(1).map(line => {
                const values = line.split(',');
                const obj = {};
                headers.forEach((header, i) => {
                    obj[header.trim()] = values[i] ? values[i].trim() : '';
                });
                return obj;
            });
        }
        
        function generateAIAnalysis(kpi) {
            console.log('AI 분석 시작 (카테고리 + 베스트 상품 + WOMEN DOWN 상세 데이터 로딩)...');
            
            // 모든 필요 데이터 병렬 로드 (women_down_detail.csv 추가)
            Promise.all([
                fetch('category_summary.csv').then(r => r.text()),
                fetch('best_products.csv').then(r => r.text()),
                fetch('women_down_detail.csv').then(r => r.text())
            ])
            .then(([categoryText, bestProductsText, womenDownDetailText]) => {
                const categories = parseCSV(categoryText);
                const bestProducts = parseCSV(bestProductsText);
                const womenDownDetail = parseCSV(womenDownDetailText);
                renderAIAnalysis(kpi, categories, bestProducts, womenDownDetail);
            })
            .catch(error => {
                console.error('AI 분석 데이터 로드 실패:', error);
                renderAIAnalysis(kpi, [], [], []);
            });
        }
        
        function renderAIAnalysis(kpi, categories, bestProducts, womenDownDetail = []) {
            console.log('AI 분석 렌더링 시작...');
            
            // 포맷 헬퍼 함수
            const formatM = (val) => Math.round(parseFloat(val) / 1000000).toLocaleString() + '백만원';
            const formatMV = (val) => Math.round(parseFloat(val)).toLocaleString() + '백만원';
            const formatP = (val) => parseFloat(val).toFixed(1) + '%';
            const formatG = (val) => (parseFloat(val) >= 0 ? '+' : '') + parseFloat(val).toFixed(1) + '%';
            const formatChange = (val) => (parseFloat(val) >= 0 ? '+' : '') + parseFloat(val).toFixed(1) + '%p';
            
            // 카테고리 데이터 매핑
            const catMap = {};
            categories.forEach(c => { catMap[c.category] = c; });
            
            // ============================================================
            // WOMEN DOWN 속성별 매출 및 성장률 (women_down_detail.csv 참조)
            // ============================================================
            let lightSales25 = 0, lightGrowth = 0;
            let middleSales25 = 0, middleGrowth = 0;
            let texturedSales25 = 0, texturedGrowth = 0;
            
            if (womenDownDetail.length > 0) {
                // 속성별 데이터 분리
                const fabricData = womenDownDetail.filter(d => d.attribute_type === 'fabric');
                const lengthData = womenDownDetail.filter(d => d.attribute_type === 'length');
                const downweightData = womenDownDetail.filter(d => d.attribute_type === 'downweight');
                
                // LIGHT 다운 매출 및 성장률
                const lightData = downweightData.find(d => d.attribute_value === 'LIGHT');
                if (lightData) {
                    lightSales25 = parseFloat(lightData.sales_25 || 0);
                    lightGrowth = parseFloat(lightData.growth_rate || 0);
                }
                
                // MIDDLE 기장 매출 및 성장률
                const middleData = lengthData.find(d => d.attribute_value === 'MIDDLE');
                if (middleData) {
                    middleSales25 = parseFloat(middleData.sales_25 || 0);
                    middleGrowth = parseFloat(middleData.growth_rate || 0);
                }
                
                // TEXTURED 소재 매출 및 성장률
                const texturedData = fabricData.find(d => d.attribute_value === 'TEXTURED');
                if (texturedData) {
                    texturedSales25 = parseFloat(texturedData.sales_25 || 0);
                    texturedGrowth = parseFloat(texturedData.growth_rate || 0);
                }
                
                console.log(`WOMEN DOWN 속성 분석: LIGHT ${Math.round(lightSales25/1000000)}백만원 (+${lightGrowth.toFixed(1)}%), MIDDLE ${Math.round(middleSales25/1000000)}백만원 (+${middleGrowth.toFixed(1)}%), TEXTURED ${Math.round(texturedSales25/1000000)}백만원 (+${texturedGrowth.toFixed(1)}%)`);
            }
            
            // 베스트 상품에서 히트 상품 정보 추출
            const hitProducts = bestProducts.filter(p => p.stock_status === '재고부족');
            
            // ============================================================
            // 1. 핵심 인사이트 (잘된 점 위주)
            // ============================================================
            const insights = [];
            
            // 전체 매출 성장
            const totalSales25 = parseFloat(kpi.total_sales_25 || 0);
            const totalSales24 = parseFloat(kpi.total_sales_24 || 0);
            const totalGrowth = parseFloat(kpi.growth_rate_total_sales || 0);
            insights.push(`<strong>25FW 누적 매출</strong> ${formatM(totalSales25)} (전년 ${formatM(totalSales24)} 대비 <span class="positive">${formatG(totalGrowth)}</span> 성장)`);
            
            // WOMEN DOWN 핵심 카테고리
            const wdSales25 = parseFloat(kpi.wd_sales_25 || 0);
            const wdGrowth = parseFloat(kpi.growth_rate_wd_sales || 0);
            const wdShare = totalSales25 > 0 ? ((wdSales25 / totalSales25) * 100).toFixed(1) : 0;
            const wdRate = parseFloat(kpi.wd_sell_rate_25 || 0).toFixed(1);
            insights.push(`<strong>WOMEN DOWN 매출</strong> ${formatM(wdSales25)} (전체의 <span class="highlight">${wdShare}%</span>, 판매율 ${wdRate}%, <span class="positive">${formatG(wdGrowth)}</span> 성장)`);
            
            // 판매율 개선
            const sellRateChange = parseFloat(kpi.sell_rate_change_total || 0);
            const totalSellRate25 = parseFloat(kpi.total_sell_rate_25 || 0);
            if (sellRateChange > 0) {
                insights.push(`<strong>전체 판매율</strong> ${totalSellRate25.toFixed(1)}% (전년 대비 <span class="positive">${formatChange(sellRateChange)}</span> 개선) - 재고 효율 향상`);
            }
            
            // 고성장 카테고리 (성장률 100% 이상) - CSV 컬럼명: sales_growth
            const highGrowthCats = categories.filter(c => parseFloat(c.sales_growth || 0) > 100 && c.category !== 'TOTAL');
            if (highGrowthCats.length > 0) {
                const topGrowthCat = highGrowthCats.sort((a, b) => parseFloat(b.sales_growth || 0) - parseFloat(a.sales_growth || 0))[0];
                insights.push(`<strong>${topGrowthCat.category} 급성장</strong> <span class="positive">${formatG(topGrowthCat.sales_growth)}</span> - 신규 성장 동력 확보`);
            }
            
            // WOMEN DOWN 히트 속성 3가지 (매출 및 성장률 표시, 줄바꿈 포함)
            const formatSalesM = (val) => Math.round(val / 1000000).toLocaleString() + '백만원';
            const formatGrowthRate = (val) => (val >= 0 ? '+' : '') + val.toFixed(1) + '%';
            
            insights.push(`<strong>WOMEN DOWN 히트 속성 3가지:</strong><br>
① 경량(LIGHT) 다운: 매출 <span class="highlight">${formatSalesM(lightSales25)}</span> (<span class="positive">${formatGrowthRate(lightGrowth)}</span> 성장)<br>
② 미드 기장(MIDDLE): 매출 <span class="highlight">${formatSalesM(middleSales25)}</span> (<span class="positive">${formatGrowthRate(middleGrowth)}</span> 성장)<br>
③ 벨벳(Textured) 소재: 매출 <span class="highlight">${formatSalesM(texturedSales25)}</span> (<span class="positive">${formatGrowthRate(texturedGrowth)}</span> 성장)`);
            
            // ============================================================
            // 2. 주의사항 (카테고리 불균형 중심)
            // ============================================================
            const warnings = [];
            
            // WOMEN vs MEN 불균형
            const womenData = catMap['WOMEN'];
            const menData = catMap['MEN'];
            
            if (womenData && menData) {
                const womenSales = parseFloat(womenData.sales_25 || 0);
                const menSales = parseFloat(menData.sales_25 || 0);
                const womenRate = parseFloat(womenData.sell_rate_25 || 0);
                const menRate = parseFloat(menData.sell_rate_25 || 0);
                const womenShare = totalSales25 > 0 ? ((womenSales / totalSales25) * 100).toFixed(1) : 0;
                const menShare = totalSales25 > 0 ? ((menSales / totalSales25) * 100).toFixed(1) : 0;
                const rateDiff = (womenRate - menRate).toFixed(1);
                
                warnings.push(`<strong>성별 불균형</strong>: WOMEN ${womenShare}% vs MEN ${menShare}% (판매율 격차 <span class="negative">${rateDiff}%p</span>) - MEN 매출 비중 확대 필요`);
            }
            
            // MEN 카테고리 분석 - CSV 컬럼명: sales_growth
            if (menData) {
                const menGrowth = parseFloat(menData.sales_growth || 0);
                const menRate = parseFloat(menData.sell_rate_25 || 0);
                warnings.push(`<strong>MEN 전체</strong>: 판매율 ${menRate.toFixed(1)}% (성장률 ${formatG(menGrowth)}) - WOMEN 대비 효율 저조, 상품력 점검 필요`);
            }
            
            // 매출 하락 카테고리 - CSV 컬럼명: sales_growth
            const decliningCats = categories.filter(c => parseFloat(c.sales_growth || 0) < 0 && c.category !== 'TOTAL');
            if (decliningCats.length > 0) {
                const decliningList = decliningCats.map(c => `${c.category}(${formatG(c.sales_growth)})`).slice(0, 3).join(', ');
                warnings.push(`<strong>매출 하락 카테고리</strong>: ${decliningList} - 원인 분석 및 대응 필요`);
            }
            
            // 재고과다 상품 (판매율 10% 미만 기준)
            const overstockProducts = bestProducts.filter(p => p.stock_status === '재고과다');
            const lowSellRateProducts = bestProducts.filter(p => parseFloat(p.sell_rate || 0) < 10);
            if (overstockProducts.length > 0 || lowSellRateProducts.length > 0) {
                warnings.push(`<strong>재고 과다 상품</strong>: 판매율 10% 미만 제품 중 재고 금액 상위 품목 프로모션 검토 필요`);
            }
            
            // ============================================================
            // 3. 향후 실행 계획 (상품 전략 중심)
            // ============================================================
            const actions = [];
            
            // 1. 히트 상품 반응생산
            if (hitProducts.length > 0) {
                const hitNames = hitProducts.slice(0, 3).map(p => p.style_name).join(', ');
                actions.push(`<strong>히트 상품 추가 생산</strong>: "${hitNames}" 즉시 반응생산 투입 (재고 소진 前 선제 대응)`);
            }
            
            // 2. WOMEN DOWN 고효율 유지
            const wdRateChange = parseFloat(kpi.sell_rate_change_wd || 0);
            if (wdRateChange > 0) {
                actions.push(`<strong>WOMEN DOWN 모멘텀 유지</strong>: 판매율 ${formatChange(wdRateChange)} 개선 지속 → 히트 스타일 후속 컬러/사이즈 확대`);
            }
            
            // 3. MEN 카테고리 전략 - MEN DOWN 성장률 검증
            if (menData) {
                const menDownData = catMap['MEN_DOWN'];
                if (menDownData) {
                    const menDownGrowth = parseFloat(menDownData.sales_growth || 0);
                    const menDownRate = parseFloat(menDownData.sell_rate_25 || 0);
                    const menDownSales24 = parseFloat(menDownData.sales_24 || 0);
                    const menDownSales25 = parseFloat(menDownData.sales_25 || 0);
                    
                    // 디버깅: 콘솔에 MEN DOWN 데이터 출력
                    console.log(`📊 MEN DOWN 24FW 매출: ${menDownSales24.toLocaleString()}원`);
                    console.log(`📊 MEN DOWN 25FW 매출: ${menDownSales25.toLocaleString()}원`);
                    console.log(`📊 MEN DOWN 성장률: ${menDownGrowth.toFixed(1)}%`);
                    
                    if (menDownSales24 > 0 && !isNaN(menDownGrowth)) {
                        // 24FW 데이터가 있고 성장률이 정상 계산된 경우
                        actions.push(`<strong>MEN DOWN 집중 육성</strong>: 성장률 <span class="positive">${formatG(menDownGrowth)}</span> → WOMEN DOWN 성공 공식 적용 (핵심 소재/기장 벤치마킹)`);
                    } else if (menDownSales25 > 0) {
                        // 24FW 데이터가 없지만 25FW 판매는 있는 경우 - 판매율 표시
                        actions.push(`<strong>MEN DOWN 집중 육성</strong>: 판매율 <span class="highlight">${menDownRate.toFixed(1)}%</span> → WOMEN DOWN 성공 공식 적용 (핵심 소재/기장 벤치마킹)`);
                    }
                } else {
                    // MEN DOWN 데이터 자체가 없는 경우
                    const menRate = parseFloat(menData.sell_rate_25 || 0);
                    actions.push(`<strong>MEN 카테고리 집중 육성</strong>: 판매율 <span class="highlight">${menRate.toFixed(1)}%</span> 개선 → 상품 라인업 확대 및 마케팅 강화`);
                }
            }
            
            // 4. 고성장 카테고리 확대 - CSV 컬럼명: sales_growth
            const womenBottom = catMap['WOMEN_BOTTOM'];
            if (womenBottom && parseFloat(womenBottom.sales_growth || 0) > 100) {
                actions.push(`<strong>WOMEN BOTTOM 확대</strong>: 성장률 <span class="positive">${formatG(womenBottom.sales_growth)}</span> → 차기 핵심 카테고리로 육성 (라인업 강화)`);
            }
            
            // 5. 재고 최적화
            if (overstockProducts.length > 0) {
                actions.push(`<strong>재고 최적화</strong>: 과다 재고 ${overstockProducts.length}개 상품 판촉 강화 + 차기 시즌 입고량 조정`);
            }
            
            // ============================================================
            // HTML 렌더링
            // ============================================================
            document.getElementById('ai-insights').innerHTML = insights.map(i => `<li>${i}</li>`).join('');
            document.getElementById('ai-warnings').innerHTML = warnings.map(w => `<li>${w}</li>`).join('');
            document.getElementById('ai-actions').innerHTML = actions.map(a => `<li>${a}</li>`).join('');
            
            console.log('AI 분석 완료');
        }
    </script>
</div>
</body>
</html>